<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en" class="no-js"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en" class="no-js"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en" class="no-js"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en" class="no-js"> <!--<![endif]-->

<head>
	<meta charset="utf-8">
	<title>Ken Egozi | Web builder</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="description" content="Ken Egozi's homepage">
	<meta name="author" content="Ken Egozi">
	<meta content="Ken Egozi's homepage" property='og:description'>
	<meta content='summary' name='twitter:card'>
	<meta content='@kenegozi' name='twitter:site'>
	<meta content='Ken Egozi | Web builder' property='og:title'>
	
	<link rel="canonical" href="http://kenegozi.com/blog/tag/castle/index.html" />

	<link rel="stylesheet" href="/assets/stylesheets/bootstrap.css" />
	<link rel="stylesheet" href="/assets/stylesheets/main.css" />

	<!-- Google Fonts -->
	<link href='http://fonts.googleapis.com/css?family=Dosis:300,400,500,600,700' rel='stylesheet' type='text/css'>
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,300,400,700' rel='stylesheet' type='text/css'>
	<link href='http://fonts.googleapis.com/css?family=Open+Sans+Condensed:700' rel='stylesheet' type='text/css'>
	<link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" type='text/css'>

	<!-- IE 9 Fallback-->
	<!--[if IE 9]>
		<link href="/assets/css/ie.css" rel="stylesheet">
	<![endif]-->

	<!-- HTML5 shim, for IE6-8 support of HTML5 elements and IE Fallback-->
	<!--[if lt IE 9]>
	  <script src="/assets/js/html5shiv.js"></script>
	<![endif]-->

	<!-- Fav and touch icons -->
	<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/img/apple-touch-icon-144-precomposed.png">
	<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/assets/img/apple-touch-icon-114-precomposed.png">
	<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/assets/img/apple-touch-icon-72-precomposed.png">
	<link rel="apple-touch-icon-precomposed" href="/assets/img/apple-touch-icon-57-precomposed.png">
	<link rel="shortcut icon" href="/assets/img/favicon.ico">
</head>
<body id="top" class="">
	
	<!-- NAVBAR -->
	<div class="navbar navbar-fixed-top navbar-top">
		<div class="container">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-nav">
					<span class="sr-only">Menu</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
			</div>
			<nav class="navbar-collapse collapse" id="main-nav" role="navigation">
				<ul class="nav navbar-nav navbar-right">
					
					<li><a href="/">home</a></li>
					<li><a href="/#about">about</a></li>
					<li><a href="/#blog">blog</a></li>
					<li><a href="/#contact">contact</a></li>
				</ul>
			</nav>
		</div>
	</div>
	<!-- END NAVBAR -->
<section class="container content tags">
  <h1 class="post_title">Posts Tagged &ldquo;castle&rdquo;</h1>
  <div class="post-sidebar">
	<h5>Follow</h5>
	<p>
		<a href="http://feeds2.feedburner.com/kenegozi">
			<img src="http://feeds.feedburner.com/~fc/kenegozi?bg=000033&amp;fg=00FF00&amp;anim=1" height="26" width="88" style="border:0" alt="">
		</a>
	</p>
	<hr/>
</div>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2011/08/15/windsor-3-is-here">Windsor 3 is here</a></h2>
    <div class="meta">
        <time>on August 15, 2011</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/open-source-software" rel="tag">open-source-software</a>
            ,&nbsp;
            
            <a href="/blog/tag/tools" rel="tag">tools</a>
            
            
        </span>
        
    </div>
    
     <p>See the announcement and grab the latest beta bits.</p>

<p><a href="http://groups.google.com/group/castle-project-users/browse_thread/thread/632ef8b47395736b">http://groups.google.com/group/castle-project-users/browse_thread/thread/632ef8b47395736b</a></p>

<p>What’s new?</p>

<p><a href="http://docs.castleproject.org/Default.aspx?Page=Whats-New-In-Windsor-3&amp;NS=Windsor">http://docs.castleproject.org/Default.aspx?Page=Whats-New-In-Windsor-3&amp;NS=Windsor</a></p>

<p>Major kudos to <a href="http://kozmic.pl/">Krzysztof Koźmic</a> for running the Windsor show so smoothly.</p>

<p>btw – a new design to the castle project website is about to be launched. It looks awesome! I’ll update once its out</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2010/04/06/my-birthday-gift-for-myself">My Birthday gift for myself</a></h2>
    <div class="meta">
        <time>on April 6, 2010</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/personal" rel="tag">personal</a>
            
            
        </span>
        
    </div>
    
     <p><a href="http://groups.google.com/group/castle-project-devel/browse_thread/thread/3067daaf559276bf/48c1e0be044698f4">http://groups.google.com/group/castle-project-devel/browse_thread/thread/3067daaf559276bf/48c1e0be044698f4</a></p>

<p> </p>

<p>I had tremendous fun coordinating work on the project, and I enjoy working with Monorail on my day job. I just do not have neither the time nor the attention to give the project anymore, and John is a much better fit, as he proved over the last few months with his efforts for the project.</p>

<p> </p>

<p>So I treated myself to a one demanding hobby less.</p>

<p> </p>

<p>I hope it will help me post more regularly now.</p>

<p> </p>

<p> </p>

<p>Interesting enough, I plan to do a few posts about recent performance issues I tackled in AspView. So I guess my MR days really aren’t over yet :)</p>


    </section>


  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2010/03/11/support-castle-project-ndash-one-click-away">Support Castle Project &ndash; one click away !</a></h2>
    <div class="meta">
        <time>on March 11, 2010</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/open-source-software" rel="tag">open-source-software</a>
            
            
        </span>
        
    </div>
    
     <p>We’re going for a Castle ad on stackoverflow.</p>

<p> </p>

<p>How can you help? hop on meta.stackoverflow.com at <a href="http://bit.ly/9eNHig">http://bit.ly/9eNHig</a>, and upvote Castle.</p>

<p> </p>

<p>thx</p>

<p> </p>

<p> </p>

<p>huge kudos to Stackoverflow for doing this, and to <a href="http://bugsquash.blogspot.com/">Mauricio Scheffer</a> for setting us up</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2010/02/25/castle-project-has-finally-moved-to-git">Castle project has finally moved to git</a></h2>
    <div class="meta">
        <time>on February 25, 2010</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/scm" rel="tag">scm</a>
            
            
        </span>
        
    </div>
    
     <p><a href="http://github.com/castleproject/">http://github.com/castleproject/</a></p>

<p> </p>

<p>thanx a bunch to the work done by <a href="http://bugsquash.blogspot.com">Mauricio Scheffer</a>, <a href="http://www.castlestronghold.com">Henry Conceição</a> and the rest of the people helping out in the process.</p>

<p> </p>

<p>fork away :)</p>


    </section>


  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2010/02/24/monorail-view-engines-usage-poll">Monorail view engines usage poll</a></h2>
    <div class="meta">
        <time>on February 24, 2010</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>If you use monorail, then go ahead and vote:</p>

<p><a href="http://twtpoll.com/bbsrdu">http://twtpoll.com/bbsrdu</a></p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2010/01/20/whatrsquos-new-in-monorail-2-dot-0">What&rsquo;s new in Monorail 2.0</a></h2>
    <div class="meta">
        <time>on January 20, 2010</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/tools" rel="tag">tools</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            ,&nbsp;
            
            <a href="/blog/tag/open-source-software" rel="tag">open-source-software</a>
            
            
        </span>
        
    </div>
    
     <p>During the long, long time it took to get from 1.0RC3 to 2.0, many things have changed, and many things were added. I probably won’t cover it all in this post, and I’ll probably forget a few things that I got so accustomed to use (I have always used trunk versions, even way before I became a committer).</p>

<p> </p>

<p> 
Programmatic config
If (like me) you do not like putting stuff in config files that the operations team do not care about, you can now run a Monorail application without the Monorail section in the web.config file.</p>

<p>How?  you’d need your Global class to implement IMonoRailConfigurationEvents.</p>

<p>e.g. from many of my websites: (I’m configuring AspView as view-engine)</p>

<p><code>
public void Configure(IMonoRailConfiguration configuration)
{
	configuration.ControllersConfig.AddAssembly(Assembly.GetExecutingAssembly());
	configuration.ViewEngineConfig.ViewPathRoot = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, &amp;quot;Views&amp;quot;);
	configuration.ViewEngineConfig.ViewEngines.Add(new ViewEngineInfo(typeof(AspViewEngine), false));
}
</code></p>

<p>you can setup many optional things that way. e.g.: </p>

<p><code>
// configue jquery as the validation engine
configuration.JSGeneratorConfiguration.AddLibrary(&amp;quot;jquery-1.2.1&amp;quot;, typeof (JQueryGenerator))
	.AddExtension(typeof (CommonJSExtension))
	.ElementGenerator
	.AddExtension(typeof (JQueryElementGenerator))
	.Done
	.BrowserValidatorIs(typeof (JQueryValidator))
	.SetAsDefault();
// configure url extensions
configuration.UrlConfig.UseExtensions = false;
</code></p>

<p>delve into the intellisense on the IMonoRailConfiguration interface to find more</p>

<p> 
Return binders
The example speaks for itself:</p>

<p>```
public class State
{
    public string Code { get; set; }
}</p>

<p>[return: JSONReturnBinder]
public State[] GetStates()
{
    // fake code for the sake of the demonstration
    return new[] { new State { Code=“CA” }, new State { Code=“WA” } };
}
```</p>

<p>will render the JSON representation of the given State array</p>

<p> 
New routing engine
see <a href="http://www.castleproject.org/monorail/documentation/trunk/advanced/routing.html">http://www.castleproject.org/monorail/documentation/trunk/advanced/routing.html</a></p>

<p>and <a href="http://kenegozi.com/blog/2009/02/10/monorail-routing-and-the-homepage-routing-rule.aspx">http://kenegozi.com/blog/2009/02/10/monorail-routing-and-the-homepage-routing-rule.aspx</a> for setting a homepage route</p>

<p> 
RescueController
A rescue controller will take care of exceptions that have happened during an Action.</p>

<p>You’d create your rescue controller, implement IRescueController, inherit from SmartDispatcherController, and setup the rescue controller in the RescueAttribute on the regular controller.</p>

<p>see more here: <a href="http://www.castleproject.org/monorail/documentation/trunk/usersguide/rescues.html">http://www.castleproject.org/monorail/documentation/trunk/usersguide/rescues.html</a></p>

<p> 
AspView
The C# based view engine became a first class citizen in Monorail. There has been many improvements there during the time, which deserve a separate post perhaps. meanwhile you can look at the aspview tag on this blog: <a href="http://kenegozi.com/blog/Tag/aspview.aspx">http://kenegozi.com/blog/Tag/aspview.aspx</a></p>

<p> </p>

<p>I can’t think of more stuff right now, so ping me if I forgot anything.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2010/01/19/monorail-2-dot-0-ndash-why-the-hell-did-it-take-so-long">Monorail 2.0 &ndash; why the hell did it take so long</a></h2>
    <div class="meta">
        <time>on January 19, 2010</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/tools" rel="tag">tools</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            ,&nbsp;
            
            <a href="/blog/tag/open-source-software" rel="tag">open-source-software</a>
            
            
        </span>
        
    </div>
    
     <p>Being an Open Source project, with very good test coverage and a very active development, most users that actually run Castle bits in production were running off of trunk anyway.</p>

<p> </p>

<p>The trunk is very stable, and the act of “release” should have simply been tagging any single commit to trunk as the 2.0 RTM.</p>

<p> </p>

<p>However, we felt that we wanted some more stuff to justify a release – like updating the documentation, re-doing samples and Visual Studio integration packages, etc.</p>

<p>That lead us to a halt, as active committers did not use neither integrations nor samples, and same for the documentation. My personal stand was (and still is) that if someone wanted an official release so badly, then that one should contribute toward this, either with time and work, or with sponsorship money to buy this time and work.</p>

<p> </p>

<p>No one did.</p>

<p> </p>

<p>A few attempts at these parts was taken, but none concluded.</p>

<p> </p>

<p>Meanwhile the project grew more and more, and parts of it became mandatory dependencies to various mainstream projects (such as NHibernate), while Windsor became more and more adopted as an IoC container of choice for many people.</p>

<p>Getting to a single point of approval across the board for the whole castle stack, without breaking third-party projects that depends on parts of Castle, became very difficult.</p>

<p> 
Breaking apart
In order to allow a manageable release process, the project was broken down to its parts. Now we have the four main projects, released on their on, with depending projects using compiled releases of the others.</p>

<p>The main projects are:</p>

<ul>
  <li>Core (de-facto including Dynamic Proxy) which is used on many other OSS projects </li>
  <li>ActiveRecord </li>
  <li>IoC stack (MicroKernel + Windsor) </li>
  <li>Monorail </li>
</ul>

<p>More details can be found on the <a href="http://www.castleproject.org/castle/projects.html">projects page of castle’s website</a></p>

<p> </p>

<p>An all-trunk builds can be retrieved <a href="http://www.hornget.net/packages/web/castle.monorail/castle.monorail-trunk">with the aid of the horn-get project</a>.</p>

<p> 
So why is Monorail last?
The reason is rather simple. Monorail depends on almost any other part of the stack. It even has subprojects such as ActiveRecord’s DataBinder (ARDataBind) which depends on ActiveRecord, and a WindsorIntegration project which depends on the IoC stack.</p>

<p>As a result we had to wait to get releases for all other projects.</p>

<p> 
What’s next?
I still have no idea. There are a few discussions going on about that (such as <a href="http://groups.google.com/group/castle-project-devel/browse_thread/thread/2c77d17327488889#">this one on the new roadmap</a>), and you are all welcome to join the debates.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2010/01/17/monorail-2-dot-0-is-out">Monorail 2.0 is out</a></h2>
    <div class="meta">
        <time>on January 17, 2010</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/tools" rel="tag">tools</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            ,&nbsp;
            
            <a href="/blog/tag/open-source-software" rel="tag">open-source-software</a>
            
            
        </span>
        
    </div>
    
     <p>After a long huge wait, finally Monorail 2.0 is out, get yours from  <a href="https://sourceforge.net/projects/castleproject/files/">https://sourceforge.net/projects/castleproject/files/</a></p>

<p> </p>

<p>HUGE thanks to John Simons and the rest of the Castle project committers, plus the rest of the good people that have supplied us with patches, bug fixes, and whatnot.</p>

<p> </p>

<p>This move somewhat concludes the move from the old 1.0RC3 release from 2007, to the new releases of the Castle stack about two years afterwards.</p>

<p> </p>

<p>I’m going to follow up with a couple of “what’s new”, “how-to upgrade” and “why the hell did it take so long” posts soon, so keep watching.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2010/01/05/nhibernate-and-activerecordrsquos-showsql-in-web-application">NHibernate (and ActiveRecord&rsquo;s) show_sql in web application</a></h2>
    <div class="meta">
        <time>on January 5, 2010</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/activerecord" rel="tag">activerecord</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            ,&nbsp;
            
            <a href="/blog/tag/nhibernate" rel="tag">nhibernate</a>
            
            
        </span>
        
    </div>
    
     <p>Looking into
When using an OR/M of any kind, it is quite worthwhile to be able to look at the SQL generated by the tool, for various reasons (such as tuning the DB, finding SELECT N+1 issues, and sheer curiosity).</p>

<p> 
Solution #1
One way of doing that is to start a profiler on the DB engine, but it has its downsides. For one, you would need a profiler tool, which is not always freely available. You might also not be able to access the DB engine with that kind of tool on various hosted environments.</p>

<p> </p>

<p>In NHibernate’s configuration (and it is also exposed to Castle’s ActiveRecord users) you can set a property names “show_sql” to true. This will cause NHibernate to spit every SQL query, along with its parameters, onto the Console. Very useful when running Tests, but when running within a Web Application, you do not have access to the Console window, and can’t really see what is going on.</p>

<p>That also leads to another problem with using a profiler on the DB engine – you won’t be able to figure out which queries belong to which web request.</p>

<p> 
Solution #2
One comprehensive solution is to use the excellent tool from <a href="http://ayende.com/">Oren Eini</a> – NhProf. I will not cover this tool here; it does lots of great stuff, and can help your development cycle. However not everyone will be willing to pay the price for using it.</p>

<p> </p>

<p>not to worry, I hereby offer you two more options, which gives you less options, but are good enough for the problem at hand, and are free.</p>

<p> 
Free solution #1
NHibernate is using log4net. it stores a <em>lot</em> of what it’s doing there. So, one can always setup a logger named “NHibernate.SQL” and get a hold of the queries. I do not cover log4net usage here. Google it up, and then set up the NHibernate.SQL logger.</p>

<p>You’d also want to setup a log4net variable for you to group the queries it gets by the web-request that needed them. You can do so by setting a property on log4net’s GlobalContext. e.g., in Application_BeginRequest:</p>

<p><code>
log4net.GlobalContext.Properties[&amp;quot;page_url&amp;quot;] = Context.Request.RawUrl + &amp;quot;|&amp;quot; + Guid.NewGuid();
</code></p>

<p>then you’d set the log appender to write the page_url value, and you’ll be able to Group By it.</p>

<p> </p>

<p> </p>

<p>But this suck. You need to depend on log4net even if you do not want to, and setup that hack-ish global property, then read it from the log4net storage, and lots of complexities. wouldn’t it be great if you could simply got a hold of the Console’s output (or at least the NH parts of it?)</p>

<p> 
Free solution #2 – even simpler
The Console object allow you to set a custom Writer to its Out stream. Meaning, you can grab the Console’s output into an in memory string during a request, and then at the end of the request, grab all lines that starts with “NHibernate:” and you’re done:</p>

<p> </p>

<p>on Application_BeginRequest:</p>

<p><code>
var writer = new StringWriter();
Console.SetOut(writer);
Context.Items[SqlLogFilter.SQL_LOG_WRITER_KEY] = writer;
</code></p>

<p>on Application_EndRequest:</p>

<p><code>
var writer = HttpContext.Current.Items[SQL_LOG_WRITER_KEY] as StringWriter;
if (writer != null)
{
	var lines = writer.ToString().Split(new[] { Environment.NewLine }, StringSplitOptions.RemoveEmptyEntries);
	var relevantLines =
		lines.Where(l =&gt; l.StartsWith(&amp;quot;NHibernate&amp;quot;) || l.Length &gt; 0 &amp;amp;&amp;amp; char.IsWhiteSpace(l[0])).ToArray()
		;
	var queries = string.Join(Environment.NewLine, relevantLines)
		.Split(new[] {&amp;quot;NHibernate:&amp;quot;}, StringSplitOptions.RemoveEmptyEntries)
		.Select(q =&gt; q.Trim());
	DoSomethingWith(queries);
}
</code></p>

<p> </p>

<p>within DoSomethingWith you can do whatever you like with the queries string collection</p>

<p> </p>

<p>The more complete solution that I use, is taking advantage of a feature in Monorail’s AspView called <a href="http://kenegozi.com/blog/2007/11/13/viewfilter-take-2.aspx">ViewFilter</a> (you can do this with ASP.NET’s output filter; look up HttpFilter. it’s not as clean, but workable). I create a filter that wrap the stuff that’s on the Application_EndRequest, turn the queries collection into a bunch of &lt;pre&gt; elements, and stick it within the view-engine’s output by simple string.Replace call, injecting these &lt;pre&gt; elements into a marker location in the markup.</p>

<p>I’d then use jQuery to make these &lt;pre&gt; elements visible when clicking somewhere secret on the screen.</p>

<p> </p>

<p>The ViewFilter’s code (for reference):</p>

<p><code>
public class SqlLogFilter : IViewFilter
{
	public static readonly string SQL_LOG_PLACEHOLDER = &amp;quot;SQL_LOG_PLACEHOLDER&amp;quot;;
	public static readonly string SQL_LOG_WRITER_KEY = &amp;quot;SQL_LOG_WRITER_KEY&amp;quot;;
	public string ApplyOn(string input)
	{
		var log = &amp;quot;&amp;quot;;
		var writer = HttpContext.Current.Items[SQL_LOG_WRITER_KEY] as StringWriter;
		if (writer != null)
		{
			var lines = writer.ToString().Split(new[] { Environment.NewLine }, StringSplitOptions.RemoveEmptyEntries);
			var relevantLines =
				lines.Where(l =&gt; l.StartsWith(&amp;quot;NHibernate&amp;quot;) || l.Length &gt; 0 &amp;amp;&amp;amp; char.IsWhiteSpace(l[0])).ToArray()
				;
			var queries = string.Join(Environment.NewLine, relevantLines)
				.Split(new[] {&amp;quot;NHibernate:&amp;quot;}, StringSplitOptions.RemoveEmptyEntries)
				.Select(q =&gt; q.Trim());
			log = queries
				.Select(q =&gt; &amp;quot;&lt;pre&gt;&amp;quot; + q + &amp;quot;&lt;/pre&gt;&amp;quot;)
				.Aggregate(&amp;quot;&amp;quot;, (q1, q2) =&gt; q1 + q2);
			var count = queries.Count();
			log = &amp;quot;&lt;p&gt;Queries: &amp;quot; + count + &amp;quot;&lt;/p&gt;&amp;quot; + log;
		}
		return input.Replace(SQL_LOG_PLACEHOLDER, log);
	}
}
</code></p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2009/12/11/windsorrsquos-logging-facility-getting-a-named-instance">Windsor&rsquo;s Logging Facility; getting a named instance</a></h2>
    <div class="meta">
        <time>on December 11, 2009</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/tools" rel="tag">tools</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            
            
        </span>
        
    </div>
    
     <p>When using Windsor’s logging facility, you’d usually take a dependency of an ILogger in your component, and have Windsor create the logger instance. The logger’s name will be of your component’s full type name.</p>

<p>e.g. for the following component:</p>

<p><code>
namespace My.Application
{
	public class UsingLogIntegration
	{
		readonly ILogger logger;
		public UsingLogIntegration(ILogger logger)
		{
			this.logger = logger;
		}
	}
}
</code></p>

<p>The logger’s name will be My.Application.UsingLogIntegration</p>

<p> </p>

<p>At times, you would need to get a logger in a different way, either because you’d want a special name, or you will be in a location where you cannot have Windsor resolve that for you as a dependency (say within an ASP.NET’s Global.asax class, which gets instantiated by ASP.NET, not by Windsor).</p>

<p> </p>

<p>The naive approach would be to ask the container for an ILogger, however if you’d try this, you’ll discover that Container.Resolve<ilogger>() will not fit your needs. So what will you do?</ilogger></p>

<p> </p>

<p>Well, the facility also sets an ILoggerFactory, which is in charge of creating loggers. So, do that instead:</p>

<p><code>
var loggerTypeOrName = GetTheTypeForTheLoggerOrAStringIfYouPrefer();
var logger = Container.Resolve().Create(loggerTypeOrName);
</code></p>

<p>ILoggerFactory.Create() can live with a type (will use the full type name as name) or with a string.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2009/10/16/castle-windsor-and-the-loggingfacility">Castle Windsor and the LoggingFacility</a></h2>
    <div class="meta">
        <time>on October 16, 2009</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/tools" rel="tag">tools</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            
            
        </span>
        
    </div>
    
     <p>So you want to be able to do some logging from your code.</p>

<p> </p>

<p>log4net for example, is a very common logging framework for .NET, and using it is pretty straight forward, and the net is full of log4net intros.</p>

<p> </p>

<p>Usage example:</p>

<p><code>
namespace My.Application
{
	public class UsingLog4netDirectly
	{
		private static log4net.ILog logger = log4net.LogManager.GetLogger(MethodBase.GetCurrentMethod().DeclaringType.FullName);
		...
		...
		...
	}
}
</code></p>

<p> </p>

<p>However, there are some caveats with using it directly.
- You get a hard dependency on log4net’s dll 
- You need to manually setup the logger instance with logger name for each class – that’s both annoying and error prone 
- And has bad impact on testing. </p>

<p>Windsor, once again, can help a lot with making it much easier. e.g:</p>

<p><code>
namespace My.Application
{
	public class UsingLogIntegration
	{
		readonly ILogger logger;
		public UsingLogIntegration(ILogger logger)
		{
			this.logger = logger;
		}
		...
		...
		...
	}
}
</code></p>

<p> </p>

<p>Windsor will take care of injecting the correct logger instance, with the name set correctly (using the class name, not needing the wacky MethodBase… stuff)</p>

<p> </p>

<p>So, what do you set this up?</p>

<p> 
Required assemblies:
Assuming you already use Windsor, you need 
- Castle.Facilities.Logging  (the logging facility) 
- Castle.Services.Logging.Log4netIntegration (or any other built-in or custom made Integration) 
- log4net.dll  (or any other actual logger implementation) </p>

<p>You actually do not need to reference these assemblies, only make sure they are on the application’s bin folder.  If you use the programmatic configuration (like I do), you’d also need the first (the facility) referenced from your code.</p>

<p> 
Registration:
<code>
container.AddFacility(&amp;quot;LoggingFacility&amp;quot;, new LoggingFacility(LoggerImplementation.Log4net));
</code></p>

<p> </p>

<p>and …  that’s it !</p>

<p> </p>

<p>You still need to setup log4net’s configuration, and tell the application where it is:</p>

<p><code>
log4net.Config.XmlConfigurator.Configure();
</code></p>

<p> 
Get a different logger for tests
Easy. Instead of configuring the facility, you simply configure another implementation. </p>

<p>container.Register(Component.For().Instance(new ConsoleLogger()));</p>

<p>If you’d explore the Castle.Core.Logging namespace you’d find few, very useful built-in implementations, such as a NullLogger (which you get by calling NullLogger.Instance), ConsoleLogger, StreamLogger (write to a file or memory stream), TraceLogger (writes to the diagnostic trace output) and WebLogger (writes to the HttpContext’s Trace, visible at trace.axd).</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2009/06/09/monorail-release-status-update-and-call-for-help">Monorail Release - Status update and call for help</a></h2>
    <div class="meta">
        <time>on June 9, 2009</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>I want to release MonoRail as soon as I can.   In order to do so I will need some help from the community. Let me list the things currently missing:
- Visual Studio wizards - for creating a new project with one of the main view-engines, with or without WindsorExtension enabled.
- Visual Studio templates - for a Controller, a ViewComponent, and view templates for the various view engines (the template should include informative comments).
- Programmatic configuration. I’ve added IAspViewConfigurationEvents, and having the same for Brail and NV would be great. </p>

<p>Any help with the above will be greatly appreciated.</p>

<p> </p>

<p>thx,</p>

<p>Ken.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2009/02/10/monorail-routing-and-the-homepage-routing-rule">Monorail Routing and the Homepage routing rule</a></h2>
    <div class="meta">
        <time>on February 10, 2009</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            
            
        </span>
        
    </div>
    
     <p>Scenario: 
You are building a Monorail web site, and want to setup a route from the application’s path to a given action (usually home/index)</p>

<p>The problem:
The pattern “/” does not work, so</p>

<p>```
RoutingModuleEx.Engine.Add(
    new PatternRoute(“Home”, “/”)
        .DefaultForArea().IsEmpty
        .DefaultForController().Is(“Home”)
        .DefaultForAction().Is(“Index”)
    );</p>

<p>```</p>

<p>will fail to serve <a href="http://yoursite/">http://yoursite/</a></p>

<p>Same will happen if you’re using the Code Generator for setting up rules.</p>

<p><code>
[PatternRoute("Homepage", "/")]
public void Index() { ... }
</code></p>

<p>will fail just the same</p>

<p>The fix:
Use the pattern “/[controller]”, like that:</p>

<p><code>
RoutingModuleEx.Engine.Add(
    new PatternRoute("Home", "/[controller]")
        .DefaultForArea().IsEmpty
        .DefaultForController().Is("Home")
        .DefaultForAction().Is("Index")
    );
</code></p>

<p>or if you’re using the Code Generator:</p>

<p><code>
[PatternRoute("Homepage", "/[controller]")]
public void Index() { ... }
</code></p>

<p>Future fix:
I’m considering adding a useful HomepageRoute that will derive from PatternRoute and will have all the needed conventions for easily setting up the homepage rule. Hopefully will be in trunk by this weekend. This will allow a simpler default syntax:</p>

<p>```
RoutingModuleEx.Engine.Add(
    new HomepageRoute()
    );</p>

<p>```</p>

<p>or (using the code generator):</p>

<p><code>
[HomepageRoute]
public void Index() { ... }
</code></p>

<p>Convention over Configuration.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2009/02/02/stuff-from-the-monorail-presentation">Stuff from the Monorail presentation</a></h2>
    <div class="meta">
        <time>on February 2, 2009</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            ,&nbsp;
            
            <a href="/blog/tag/open-source-software" rel="tag">open-source-software</a>
            
            
        </span>
        
    </div>
    
     <p>Here is the promised presentation from the talk I gave yesterday, for the Web Developers Community at Microsoft offices in Ra’anana.</p>

<p>The sources for the demo I showed are hosted on github. If you’re not using git (and you should give it a try if that is the case), you can grab a zip of the latest snapshot from that site (there’s a ‘download’ button). Git is worth using if only for the great service given by github.</p>

<p><a href="http://github.com/kenegozi/monorail-aspview-demo/tree/master">http://github.com/kenegozi/monorail-aspview-demo/tree/master</a></p>

<p>As for the slides - I tried using scribd and SlideShare, both attempts ended up not too well. I’ll try to get a better format later on.</p>

<p>I’d like to thank <a href="http://blogs.microsoft.co.il/blogs/noam/">Noam King</a>, the organiser of the WDC group, for having me as a speaker. I’d also like to thank <a href="http://damieng.com/">Damien Guard</a> who have created the <a href="http://damieng.com/blog/2008/05/26/envy-code-r-preview-7-coding-font-released">Envy Code R font</a> which I used during the presentation.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2009/01/31/monorail-talk">Monorail talk</a></h2>
    <div class="meta">
        <time>on January 31, 2009</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>I’ll be giving a talk on Monorail tomorrow evening, at Microsoft offices in Ra’anana.</p>

<p>Registration details are here:</p>

<p><a href="https://msevents.microsoft.com/CUI/EventDetail.aspx?EventID=1032402276&amp;Culture=he-IL">https://msevents.microsoft.com/CUI/EventDetail.aspx?EventID=1032402276&amp;Culture=he-IL</a></p>

<p>I’ll try to upload the presentation beforehand to here (no promises though). </p>

<p>See you there :)</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2008/10/29/monorail-usage-poll">Monorail usage poll</a></h2>
    <div class="meta">
        <time>on October 29, 2008</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/open-source-software" rel="tag">open-source-software</a>
            
            
        </span>
        
    </div>
    
     <p>Following <a href="http://kenegozi.com/Blog/2008/10/29/introducing-monorail-project.aspx">my last post</a>, I’ve put up a quick poll for trying to grasp some knowledge about the way people are using (or not using) MonoRail.</p>

<p>It’s not complete, and there will be further polls as I can already think of questions I have for the community, that did not make their way to this poll, and are very important imo.</p>

<p>So, if you care for the future of MonoRail, please do spare some moments to fill in the poll. Be nice and write down your feelings, pain-points and general rants in the text areas. I won’t be offended by anything.</p>

<p>No personal details will be published (at least not deliberately - and I don’t believe anyone will hack into the lousy SQL server it’s stored on).</p>

<p>so, without further ado, I give you the poll:</p>

<p><a href="http://kenegozi.com/monorailpoll.html">http://kenegozi.com/monorailpoll.html</a></p>


    </section>


  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2008/10/29/introducing-monorail-project">Introducing Monorail Project</a></h2>
    <div class="meta">
        <time>on October 29, 2008</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/open-source-software" rel="tag">open-source-software</a>
            
            
        </span>
        
    </div>
    
     <p>From the mailing list:</p>

<p>… the PMC decided to make a few changes to the Castle Project:- Projects will be split- Each project will have a leader (positions open to any committer)By that we intent to fix our release debt. as having each project running individually allow us to release and document each one of them without dragging/waiting for others.</p>

<p>We still haven’t decided how to solve dependencies and such, but with time I’m certain we’ll be able to come up with solution that will benefit the community.  </p>

<p>ah, and I have been the one appointed as Project Leader for Monorail.  </p>

<p>Quoting again from the mailing list:<br />
We would expect from the leaders to oversee the development (near and long term), set up goals, roadmaps, coordinate the documentation effort and release it.</p>

<p>So my main effort now will be to push a Monorail 1.0 RTM release out of the door. There are many things that need be done before this comes true as in terms of the non-code aspects (like docs, wizards, etc.), Monorail is not as ready as ActiveRecord for example.</p>

<p>I will be posting some specific requests for help on the various tasks that will need to be done. I hope that with the aid of the community, we will have a release soon-ish.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2008/10/15/single-and-looking">Single and looking</a></h2>
    <div class="meta">
        <time>on October 15, 2008</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/architecture" rel="tag">architecture</a>
            ,&nbsp;
            
            <a href="/blog/tag/client-side" rel="tag">client-side</a>
            ,&nbsp;
            
            <a href="/blog/tag/css" rel="tag">css</a>
            ,&nbsp;
            
            <a href="/blog/tag/html" rel="tag">html</a>
            ,&nbsp;
            
            <a href="/blog/tag/c-sharp" rel="tag">c-sharp</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/nhibernate" rel="tag">nhibernate</a>
            ,&nbsp;
            
            <a href="/blog/tag/personal" rel="tag">personal</a>
            ,&nbsp;
            
            <a href="/blog/tag/javascript" rel="tag">javascript</a>
            ,&nbsp;
            
            <a href="/blog/tag/open-source-software" rel="tag">open-source-software</a>
            
            
        </span>
        
    </div>
    
     <p>explanation (before the wife kills me): I have some free time in the coming months, so I’m looking for interesting consulting gigs.</p>

<p>So, if you’re in a company / dev team, and looking for some help with Castle (Windsor, MonoRail), NHibernate, or general information system design and architecture advices or training, setting up build and test environments, or any other of the things I rant about in this blog, then I’m your guy. </p>

<p>I also do web-client ninja work, dancing the crazy css/html/javascript tango (jQuery: yes, Ms-Ajax: no) </p>

<p>I currently live in Israel, but I’m fine with going abroad for short terms if you’re an off-shore client. </p>

<p>you can contact me at “ken@kenegozi.com”</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2008/09/22/ioc-dot-net-smackdown">IoC.NET Smackdown</a></h2>
    <div class="meta">
        <time>on September 22, 2008</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/architecture" rel="tag">architecture</a>
            ,&nbsp;
            
            <a href="/blog/tag/tools" rel="tag">tools</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            
            
        </span>
        
    </div>
    
     <p>I’ve just came across a comparison on IoC containers in the .NET world:</p>

<ul>
  <li><a href="http://blog.ashmind.com/index.php/2008/08/19/comparing-net-di-ioc-frameworks-part-1/">http://blog.ashmind.com/index.php/2008/08/19/comparing-net-di-ioc-frameworks-part-1/</a></li>
  <li><a href="http://blog.ashmind.com/index.php/2008/09/08/comparing-net-di-ioc-frameworks-part-2/">http://blog.ashmind.com/index.php/2008/09/08/comparing-net-di-ioc-frameworks-part-2/</a></li>
</ul>

<p>Haven’t read it yet cuz Im actually off-computer right now (the lappy is attached to the living room TV, and the break in the movie is almost over), but MAN is has COLOUR charts, so you can <a href="http://www.imdb.com/title/tt0309356/">bet your arse</a> I’m gonna read it later.</p>

<p>Not that I’m excited. I’m pretty sure that (INSERT WINNER HERE LATER) will prove to be the best IoC ever.</p>


    </section>


  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2008/09/15/creating-a-custom-parameter-binder-for-monorail-actions-iparameterbinder">Creating a custom parameter binder for MonoRail actions - IParameterBinder</a></h2>
    <div class="meta">
        <time>on September 15, 2008</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            
            
        </span>
        
    </div>
    
     <p>Background
When using SmartDispatcherController as a base class for a MonoRail’s Controller, there are built-in smarts for binding values from the client (Form, QueryString, Request.Params) into .NET data types.So, assuming the request holds “age=30”, and there’s an action </p>

<p><code>
public void SomeAction(int age) ...
</code>
then the integer variable ‘age’ will get populated with the value 30. </p>

<p>This will work for every .NET primitive (int, string, bool) and even DateTime and Guid. If the value is missing from the request, a default value will be set, for example - 0 for integers, or null of nullable types.</p>

<p>There’s also DataBindAttribute that allow you to bind values to a non-primitive DTO object.Say you have </p>

<p><code>
public class User
{
    string Name {get;set;}
    int Age {get;set;}
}
</code>
and that your request is holding “User.Name=Ken&amp;User.Age=30”, then the following action
<code>
public void SomeAction([DataBind("User")] User user) ...
</code>
will bind the age and name into a new instance of User. </p>

<p>Problem
Yesterday, on Castle devs mailing list Andre Loker was asking about a way to bind a value to an action argument, but with the value having a name that cannot match a c# variable name.For example, let’s say that the request is holding “User.Age=30”, but you do not want to bind to a User instance (through DataBind) but you want only the Age part, into an integer variable.You certainly cannot have your action signature look like </p>

<p><code>
public void SomeAction(int User.Age) ...
</code></p>

<p>Solution:
Luckily for us, MonoRail was built with extensibility in mind (and whenever a user feels something more is required in the field of extensibility, a patch is always welcome :) ).The extension point here is the IParameterBinder interface, which is being used in DataBindAttribute to let the framework know that the attribute is to be used for data binding.</p>

<p>IParameterBinder:</p>

<p>```
/// &lt;summary&gt;
/// Implemented by attributes that wants to perform 
/// some conversion to populate a smart dispatcher 
/// action argument.
/// &lt;/summary&gt;
public interface IParameterBinder
{
    /// &lt;summary&gt;
    /// Calculates the param points. Implementers should return value equals or greater than
    /// zero indicating whether the parameter can be bound successfully. The greater the value (points)
    /// the more successful the implementation indicates to the framework
    /// &lt;/summary&gt;
    /// <param name="context" />The context.&lt;/param&gt;
    /// <param name="controller" />The controller.&lt;/param&gt;
    /// <param name="controllerContext" />The controller context.&lt;/param&gt;
    /// <param name="parameterInfo" />The parameter info.&lt;/param&gt;
    /// <returns></returns>
    int CalculateParamPoints(IEngineContext context, IController controller, IControllerContext controllerContext, ParameterInfo parameterInfo);</p>

<pre><code>/// &lt;summary&gt;
/// Binds the specified parameters for the action.
/// &lt;/summary&gt;
/// &lt;param name="context"&gt;The context.&lt;/param&gt;
/// &lt;param name="controller"&gt;The controller.&lt;/param&gt;
/// &lt;param name="controllerContext"&gt;The controller context.&lt;/param&gt;
/// &lt;param name="parameterInfo"&gt;The parameter info.&lt;/param&gt;
/// &lt;returns&gt;&lt;/returns&gt;
object Bind(IEngineContext context, IController controller, IControllerContext controllerContext, ParameterInfo parameterInfo); } ```
</code></pre>

<p>The CalculateParamPoints function is used by the framework to help SmartDispatcherController decide with overload of a given action should be used.</p>

<p>the Bind function, well, binds the request data into the given parameter.</p>

<p>Here is a naive BindFrom attribute, which is to be used like that:</p>

<p><code>
public void SomeAction([BindFrom("User.Age")] int age) ...
</code></p>

<p>The code:</p>

<p>```</p>

<p>[AttributeUsage(AttributeTargets.Parameter, AllowMultiple = false, Inherited = false)]
public class BindFromAttribute : Attribute, IParameterBinder
{
    private readonly string parameterName;
    private readonly IDataBinder binder = new DataBinder();</p>

<pre><code>public BindFromAttribute(string parameterName)
{
    if (string.IsNullOrEmpty(parameterName))
    {

        throw new ArgumentException("parameterName must not be null or empty", "parameterName");
    }
    this.parameterName = parameterName;
}

public string ParameterName
{
    get { return parameterName; }
}

public int CalculateParamPoints(IEngineContext context, IController controller, IControllerContext controllerContext, ParameterInfo parameterInfo)
{
    var token = context.Request[parameterName];
    if (CanConvert(parameterInfo.ParameterType, token))
        return 10;
    return 0;
}

static bool CanConvert(Type targetType, string token)
{
    if (token == null)
        return false;



    try

    {
        Convert.ChangeType(token, targetType);
        return true;
    }
    catch(FormatException)
    {
        return false;
    }
}

public object Bind(IEngineContext context, IController controller, IControllerContext controllerContext, ParameterInfo parameterInfo)
{
    var token = context.Request[parameterName];
    if (CanConvert(parameterInfo.ParameterType, token) == false)
        return null;

    return Convert.ChangeType(token, parameterInfo.ParameterType);
} }
</code></pre>

<p>```</p>

<p>Conclusion
The IParameterBinder interface is very important as it allow a user to extend MonoRail to his exact needs. If you want to learn more about that interface and it’s uses, the best places to look are DataBindAttribute.cs in Castle.MonoRail.Framework/Attributes, and ARDataBindAttribute.cs in Castle.MonoRail.ActiveRecordSupport</p>

<p>As a side note, I’m thinking about adding the discussed behaviour into the default DataBindAttribute, so one would be able to bind into primitives, say from “User.Age=30&amp;User.Name=Ken” using </p>

<p><code>
public void SomeAction([DataBind("User")] int age, [DataBind("User")] string name) ...
</code></p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2008/08/23/factorysupportfacility-gotcha">FactorySupportFacility gotcha</a></h2>
    <div class="meta">
        <time>on August 23, 2008</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/tools" rel="tag">tools</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            
            
        </span>
        
    </div>
    
     <p>The FactorySupportFacility in Windsor is very useful but there’s a little something to be aware of when using it.</p>

<p>What is it?
This facility allows you to tell the container that when a given service is to be resolved, instead of new-ing it, it should call a factory method to obtain an instance.</p>

<p>This is very useful for context objects (like DbContext, HttpContext etc.) , which are usually being supplied by a framework thus you can’t have the container instantiate them directly. So, assuming you want to inject a ISomeContext object into a service, you need to create a factory that can obtain it for you:</p>

<p>```</p>

<p>public class SomeContextFactory</p>

<p>{</p>

<p>ISomeContext ObtainFromFramework()</p>

<p>{</p>

<pre><code>  return SomeFrameworkContext.Current; //or whatever
</code></pre>

<p>}</p>

<p>}</p>

<p>```</p>

<p>then you can setup the container to use that factory when injecting the context</p>

<p>The usage:
Online examples:
- <a href="http://www.jroller.com/hammett/entry/castle_s_factory_facility">http://www.jroller.com/hammett/entry/castle_s_factory_facility</a>(using XML config, and it’s somewhat old - that’s the first announcment of this facility from Hammet back in the mesosoican era).
- <a href="http://mawi.org/ProgrammaticCastleMicrokernelWindsorAmpTheFactoryFacility.aspx">http://mawi.org/ProgrammaticCastleMicrokernelWindsorAmpTheFactoryFacility.aspx</a>(using programmatic container initialisation).</p>

<p>And, the gotcha:
When taking the programmatic road, you must follow this order of doing things:
- Create the facility instance:</p>

<p><code>
var facility = new FactorySupportFacility();
</code>
- Add it to the container</p>

<p><code>
container.Kernel.AddFacility("factory.support", facility);
</code>
- Register your factories in the facility:</p>

<p><code>
facility.AddFactory&lt;ISomeContext, SomeContextFactory&gt;("some.context", "ObtainFromFramework");
</code></p>

<p>If you mix 2 and 3, it would break.</p>

<p>There reason of course is that registering the factory into the facility, mean that the facility needs no know about the current container and kernel. This is being done in step 2 so you simply can’t do step 3 before that.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2008/07/30/on-babies-entities-controllers-and-confidence-votes">On babies, entities, controllers and confidence votes</a></h2>
    <div class="meta">
        <time>on July 30, 2008</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/miscellanea" rel="tag">miscellanea</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/altnetuk" rel="tag">altnetuk</a>
            ,&nbsp;
            
            <a href="/blog/tag/alt-net-israel" rel="tag">alt-net-israel</a>
            
            
        </span>
        
    </div>
    
     <p>The Sharks
Here in Israel, there’s a reality/documentary TV show called “The Sharks”.</p>

<p>It’s about people who have some kind of a business idea, and are looking for investors.</p>

<p>Each entrepreneur gets a few minutes to present their idea and business plan in front of 4-5 well-known Israeli businessmen, trying to get their support in return for percentages of their project.</p>

<p>One can differentiate the totally bad projects with possibly OK projects, simply on the basis of a proper preparations. Some projects are simply vague ideas that popped up on someone’s head, without any business plan of any kind.</p>

<p>Then you have the projects that comes with a detailed business plan, market research, pricing policies and what-not. These are of course the ones that the Sharks (potential investors) show interest in. The interesting bit is that most of the times, instead of asking strictly business related questions, they tend give more importance to the actual usability of the proposed product/service/whatever. They try to get in the head of the potential consumers and look for Achilles’ heels from the user’s point of view.</p>

<p>Solving consumer problems
The point is, that you cannot create a product or service to solve problems that you <strong>think</strong> that people have. You have to solve <strong>actual</strong> problems that potential consumers are facing.</p>

<p>Paraphrasing DHH from a presentation lately, “It’s not Rocket Surgery”. You should simply solve people’s problems, otherwise they won’t be interested. </p>

<p>self consumer
Who is the better consumer than yourself?</p>

<p>Example: There’s this person I know, who will sell you <a href="http://www.babyhugs.co.uk/">baby carriers</a>. They look very simple in first glance, but then you see that it’s actually pretty useful - it’s adjustable, you can re-use the same carrier in several carrying positions (low, high, front, back), and it’s comfortable for parent and baby. The thing is - she didn’t wake up one day with a crazy idea, hoping it’d match someone’s needs. She made one for herself and her baby, making it better with time, and <strong>then</strong> thought - ‘hey someone else might like it’</p>

<p>Going back to DHH and his presentation, he states there clearly that the whole RubyOnRails thing was simply something he needed <strong>for</strong> his day job, so it became very useful, as the consumer (himself) was giving him direct feedback during the development process.</p>

<p>Same can be said on many OSS projects, like NHibernate, the whole Castle stack and many more.</p>

<p>I can testify on AspView, which I created to make my day job easier and more fun, as I disliked WebForms and my employer insisted on ASP.NET and C# all around - that was my best shot. I got immediate feedbacks from the consumer (myself and my team members) so it stayed focused on solving consumer needs.</p>

<p>Demonstrate trust in your tools
You should be trustworthy. I evangelise the use of good tools, and I name the Castle stack, NHibernate, Rhino Commons, and more as good tools. I can do this whole heartedly since I use these very tools for my day jobs, on paid projects, not only for pet projects. </p>

<p>And if you are not a consumer
Take ASP.NET MVC. This project is being internally run by a team of developers, who their day job is to build this tool, not to use it. On the surface it presents a major problem, no consumer feedback.</p>

<p>The way they chose to solve this problem was pretty simple. Expose as much as you can to the public. Push potential users to play with the API, experiment with use cases, build extensions, whatnot. Continuously grab community input, incorporate it in the product, and get new feedback. All that has started from the earliest stages by ScottGu, then Phil Haack. The while team seam to be everywhere, from mailing lists to ALT.NET conferences, getting consumer input and building around it.</p>

<p>The outcome is that they can focus on solving consumer problems, and the progress of improvements is amazing. It got to the point that I have no problem at all with using ASP.NET MVC, even though I’m an active member in MonoRail. Personally I prefer MonoRail, but I really see ASP.NET MVC as a viable option, and recommend it as a possible solution.</p>

<p>Opposite examples
Take the Entity Framework. I’ve been hearing about this beast from 2005. However being able to get the feel of it took way too long. Meanwhile it appear that a lot of stuff has been introduced into it, that might not even be interesting to consumers, while rendering fixing the consumers’ problems more difficult.</p>

<p>And as for trusting your own tools - I’ve heard once that Visual Source Safe was never used internally for development within Microsoft. I also don’t really believe that there is a single public major website under Microsoft’s umbrella that uses SqlDataSource, heavily customised GridView components and other widely demo-ed Webforms stuff. </p>

<p>Confidence
Technologies like Silverlight, ASP.NET MVC, not to mention the more experimental stuff like IronXYZ and F#, find their way into community review, and even to internal production use. Microsoft are voting confidence in these products, so do I.</p>

<p>ALT.Microsoft
So as far for the notorious Vote of No Confidence in EF, I never have joined it as it simply make no sense imo. It simply does not interest me enough to even vote. They way I see it, EF belongs next to WebForms, while MVC/IronXYZ/F#/etc are legitimate ALT.NET</p>

<p>Cuz ALT.NET is not about opposing anyone. Definitely not MS - hey these guys brought us the CLR and BCL.</p>

<p>It’s also not about being the freedom guerilla fighters fighting the evil Corporate. Not at all.</p>

<p>I think that ALT.NET is a great idea, just like XP (Extreeme Programming), and like XP it has a bad name, as it implies ‘niche’, ‘alternative’, ‘scary’, ‘elitist’, ‘vane’. </p>

<p>It’s not.</p>

<p>It’s about good tools, built to help make us developers work better, and have more fun during. Parts of the DevDiv are as ALT.NET as it gets.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2008/07/19/monorail-sample-gone-aspview">MonoRail sample gone AspView</a></h2>
    <div class="meta">
        <time>on July 19, 2008</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>Some more AspView love:</p>

<p>This dude, <a href="http://morten.lyhr.dk/">Morten Lyhr</a> (great blog - go on and subscribe), has taken the sample MonoRail Getting Started project and AspView-ed it.</p>

<p> </p>

<p><a href="http://morten.lyhr.dk/2008/07/learning-by-sample-monorail-and-aspview.html">Take a look</a>.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2008/07/16/i-didnt-brake-the-build">I didn't brake the build</a></h2>
    <div class="meta">
        <time>on July 16, 2008</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>After making it build locally and reaching the conclusion that AspView builds correctly as part of the main Castle build , I’ve commited the changes to the repository, and the build server appear to agree with me:</p>

<p><img src="http://kenegozi.com/Blog/uploaded/WindowsLiveWriter/Ididntbrakethebuild_D22C/c49d0e53-906c-49fa-9f00-1508189902d1.png" alt="Build_Succeded_on_the_build_server" /></p>


    </section>


  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2008/07/16/build-succeeded-a-happy-red-screen">Build Succeeded - A happy red screen</a></h2>
    <div class="meta">
        <time>on July 16, 2008</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>can you guess why this makes me happy?</p>

<p><img src="http://kenegozi.com/Blog/uploaded/WindowsLiveWriter/BuildSucceededAhappyredscreen_C613/b7f64277-21b7-46e7-a831-112db41ae514.png" alt="Build_Succeded" /></p>

<p>This is the output of building Castle’s trunk, both for .NET 3.5 and .NET 2.0, after inserting AspView into the core project. Took me a while as I had to:
- Change the Xunit tests into NUnit - to match the runner     wasn’t too complicated, though I has to manually add [SetUp] and [TestFixture] everywhere, as they’re not needed in Xunit
- Setting the correct Castle license snippet on every file
- Making the build pass and run all the tests correctly.     now that was a royal PITA, as part of the tests include compiling view templates from source files, and copying files to the build folder using NANT is not simple, as the <copy> task flattens the source directory structure. For now I settled on specifying each views folder in the build file but Im looking at improving that bit.</copy></p>

<p>So, soon enough (hopefully by the end of this day) you’d be able to see AspView on the build server.</p>

<p> </p>

<p>Thx again for all of the users and patch-contributors for your faith in this library.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2008/07/12/building-castle-on-vista">Building Castle on Vista</a></h2>
    <div class="meta">
        <time>on July 12, 2008</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            
            
        </span>
        
    </div>
    
     <p>So after moving to Vista last week, I’ve tried a full castle build with tests.</p>

<p> </p>

<p>Things I had to take care for it to run properly (from easy to not-as):
- Make sure Nant is in the path
- Make sure that NUnit 2.2.x is in the path     explanation: for some reason, the remoting tests fail when being run from NUnit 2.4.x   As I’d rather not to gac any specific NUnit version, I have on my C:\Program Files two separate directories, one called "NUnit 2.2.8" and one called "NUnit 2.4.7", and the shortcut I use for firing a Command Prompt for Castle is making sure that NUnit 2.2.8 is in the path.
- Setup the test databases for DB related integration tests (as explained in "How To Build.txt")
- Make sure that you use an elevated command prompt - the shortcut I’ve mentioned on 2. is set as "Run As Administrator"
- To make the WcfIntegration facility tests run correctly, you need to run this thing once:     sc.exe config NetTcpPortSharing start= demand
- some config files are missing from the build folder (Castle\build). until we fix it in the nant script, you have to manually run     copy ..\Facilities\Wcf\Castle.Facilities.WcfIntegration.Tests\Configure*.xml ..\Build</p>

<p> </p>

<p>Now that I have a way to run the build and make sure all tests pass, I can start working on my next Castle assignment - bringing AspView into the core project, but that’s a whole other post so keep your RSS reader open …</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2008/06/28/filebinderattribute-to-ease-fileupload-in-monorail">FileBinderAttribute to ease FileUpload in MonoRail</a></h2>
    <div class="meta">
        <time>on June 28, 2008</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/asp-net-2-0" rel="tag">asp-net-2-0</a>
            ,&nbsp;
            
            <a href="/blog/tag/c-sharp" rel="tag">c-sharp</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            
            
        </span>
        
    </div>
    
     <p>Following <a href="http://www.hanselman.com/blog/ABackToBasicsCaseStudyImplementingHTTPFileUploadWithASPNETMVCIncludingTestsAndMocks.aspx">Scott Hanselman’s post</a> on FileUpload in ASP.NET MVC, I’ll add here a few bits on doing that in MonoRail.</p>

<p>First, as MonoRail is an extension on top of plain ol’ ASP.NET, just as ASP.NET MVC is, you can do the exact same thing - i.e iterate over Request.Files, and use a mocked Files collection for test or something.</p>

<p>But as the action parameters binder is very smart, and easily extensible, it’s even nicer to just bind the posted data to a HttpPostedFile, using a FileBinder:</p>

<!-- code formatted by http://manoli.net/csharpformat/ -->
<p>{% highlight c# %}
   1:  [AttributeUsage(AttributeTargets.Parameter, AllowMultiple = false, Inherited = false)]   2:  publicclass FileBinderAttribute: Attribute, <strong>IParameterBinder</strong>   3:  {   4:  publicint CalculateParamPoints(IEngineContext context, IController controller, IControllerContext controllerContext, ParameterInfo parameterInfo)   5:      {   6:  var key = parameterInfo.Name;   7:  return context.Request.Files[key] != null ? 10 : 0;   8:      }   9:    10:  publicobject Bind(IEngineContext context, IController controller, IControllerContext controllerContext, ParameterInfo parameterInfo)  11:      {  12:  var key = parameterInfo.Name;  13:  return context.Request.Files[key] as HttpPostedFile;  14:      }  15:  }{% endhighlight %}</p>

<p>So a custom binder is an attribute, that implements IParameterBinder, a two methods interface:
- CalculateParamPoints() - is for helping the framework correctly guess the best candidate of the action overloads. If the file exists in the request then it makes an action with a HttpPostedFile parameter with the name of the file upload name, a better candidate than an overload with a String parameter with the same name. </p>

<ul>
  <li>Bind() - well, kinda’ self explanatory.</li>
</ul>

<p>so now you’re action can look like this:</p>

<p>{% highlight c# %}
   1:  publicvoid Save([FileBinder] HttpPostedFile myfile)   2:  {   3:  if (myFile != null)   4:      {   5:  // do stuff with the file   6:      }   7:  }{% endhighlight %}</p>

<p>Cool? well actually what really is cool is that binding to HttpPostedFile is baked into MonoRail to begin with - so you don’t even need this FileBinderAttribute at all ! you can simply</p>

<p>{% highlight c# %}
   1:  publicvoid Save(HttpPostedFile myfile)   2:  {   3:  if (myFile != null)   4:      {   5:  // do stuff with the file   6:      }   7:  }{% endhighlight %}</p>

<p>So why did I show you that?</p>

<p>Testablility.</p>

<p>Since HttpPostedFile is not easily mockable* (cuz it’s bloody sealed and not new-able), you should do what you always do when in need to bypass one of these un-testable hard-to-test* sealed classes: Adapter pattern. Introduce IHttpPostedFile, and supply your own HttpPostedFile encapsulating the built in one.</p>

<p>so:</p>

<p>{% highlight c# %}</p>

<p>1:  [AttributeUsage(AttributeTargets.Parameter, AllowMultiple = false, Inherited = false)]   2:  publicclass FileBinderAttribute: Attribute, <strong>IParameterBinder</strong>   3:  {   4:  publicint CalculateParamPoints(IEngineContext context, IController controller, IControllerContext controllerContext, ParameterInfo parameterInfo)   5:      {   6:  var key = parameterInfo.Name;   7:  return context.Request.Files[key] != null ? 10 : 0;   8:      }   9:    10:  publicobject Bind(IEngineContext context, IController controller, IControllerContext controllerContext, ParameterInfo parameterInfo)  11:      {  12:  var key = parameterInfo.Name;</p>

<p>13:          var file = context.Request.Files[key] as HttpPostedFile;    14:  return file == null ? null : HttpPostedFileAdapter(file);  15:      }  16:  }
{% endhighlight %}</p>

<p>and</p>

<p>{% highlight c# %}
   1:  publicvoid Save([FileBinder] IHttpPostedFile myfile)   2:  {   3:  if (myFile != null)   4:      {   5:  // do stuff with the file   6:      }   7:  }{% endhighlight %}</p>

<ul>
  <li>Yes Roy, I know you can throw some TypeMock magic at it</li>
</ul>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2008/06/22/castle-dot-tools-dot--in-castle-contribs-repository-has-moved-a-bit">Castle.Tools.* in Castle Contrib's repository has moved a bit</a></h2>
    <div class="meta">
        <time>on June 22, 2008</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/css" rel="tag">css</a>
            ,&nbsp;
            
            <a href="/blog/tag/html" rel="tag">html</a>
            ,&nbsp;
            
            <a href="/blog/tag/tools" rel="tag">tools</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/sql" rel="tag">sql</a>
            
            
        </span>
        
    </div>
    
     <p>The tools (various small helper libraries) are now under <a href="http://svn.castleproject.org:8080/svn/castlecontrib/Tools/">http://svn.castleproject.org:8080/svn/castlecontrib/Tools/</a></p>

<p>what’s in there:
- <a href="http://svn.castleproject.org:8080/svn/castlecontrib/Tools/Castle.Tools.StaticMapGenerator/">Castle.Tools.StaticMapGenerator</a> - That one creates a typed tree representing js/css/image files on the site’s filesystem. more here:<a href="http://kenegozi.com/Blog/2008/01/17/staticmapgenerator-for-asp-dot-net-first-teaser.aspx">http://kenegozi.com/Blog/2008/01/17/staticmapgenerator-for-asp-dot-net-first-teaser.aspx</a>Which reminds me that I need to add .swf files to the mix …
- <a href="http://svn.castleproject.org:8080/svn/castlecontrib/Tools/Castle.Tools.SQLQueryGenerator/">Castle.Tools.SQLQueryGenerator</a> - That one is for building plain old SQL strings in a typed and intellisense friendly way.more here:<a href="http://kenegozi.com/Blog/2008/01/27/already-added-stuff-to-sql-query-generator.aspx">http://kenegozi.com/Blog/2008/01/27/already-added-stuff-to-sql-query-generator.aspx</a>
- <a href="http://svn.castleproject.org:8080/svn/castlecontrib/Tools/Castle.Tools.QuerySpecBuilder/">Castle.Tools.QuerySpecBuilder/</a> - The new kid in the block. That’s a tool that is used to build specs programmatically, which would later be translated to a SQL string for your flavour of DAL. The generated SQL is mostly ANSI compliant, apart from the Paging syntax which is TSQL only currently, but at some point I’ll add an extension point to allow other syntaxes.I also have an external thing to make it extremely useful with NHibernate’s ISQLQuery.I’ll blog about all that when I’ll have a little time.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2008/05/14/monorail-talk-at-the-developers-group">MonoRail talk at The Developers Group</a></h2>
    <div class="meta">
        <time>on May 14, 2008</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/architecture" rel="tag">architecture</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>Have just came back from my talk, given for <a href="http://www.richplum.co.uk/">The Developers Group</a> in Microsoft’s Victoria offices, London UK.</p>

<p>Took me a bit to find the place, as the building does not say “Microsoft” on the outside (as opposed to the offices in Israel).</p>

<p>The presentation went pretty much ok, considering it was my first time actually presenting in English, in front of an English crowd, and considering I had a PC malfunction that has forced me to recreate the Demo project, on the train today … Just finished it up 5 seconds before connection the laptop to the projector.</p>

<p>I didn’t manage to squeeze in some of the parts that I wanted to, like JSONReturnBinder and Windsor integration, and like Unit-Testing controllers and views, but I do hope that I managed to do justice with this wonderful stack, within the limited time and my horrible English …</p>

<p>Unfortunately, I missed the post-meeting-pub-thing as I just happened to leave the place last and didn’t see where everyone did go, so if you were there and has some questions, please do not hesitate to leave them here as comments.</p>

<p>Anyway, as promised, here are <a href="http://kenegozi.com/blog/files/download.aspx?filename=monorail-demo.zip">the slides and the demo project</a>.</p>

<p>If you are using <a href="http://git.or.cz/">git</a>, and have a <a href="http://github.com/">git-hub</a> account, then you would be able to follow the demo project’s source at <a href="http://github.com/kenegozi/monorail-aspview-demo/tree/master">http://github.com/kenegozi/monorail-aspview-demo/tree/master</a></p>

<p>Have fun.</p>

<p>P.S</p>

<p>I’d like to thank Jason from The Developers Group, and Nina from Microsoft, who have helped with the administration part of things. Everything went smooth despite my late arrival. I’d also like to thank the attendees for their patience and listening. I hope you’ve enjoyed it, I definitely have :) </p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2008/05/09/using-nhibernates-named-queries-with-activerecord">Using nhibernate's named queries with ActiveRecord</a></h2>
    <div class="meta">
        <time>on May 9, 2008</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/activerecord" rel="tag">activerecord</a>
            ,&nbsp;
            
            <a href="/blog/tag/nhibernate" rel="tag">nhibernate</a>
            ,&nbsp;
            
            <a href="/blog/tag/hql" rel="tag">hql</a>
            
            
        </span>
        
    </div>
    
     <p>One of the methods of querying the DB when using NHibernate, is to issue <a href="http://www.hibernate.org/hib_docs/reference/en/html/queryhql.html">HQL</a> queries. HQL stands for “Hibernate Query Language”. It has a SQL-like syntax and is very intuitive for people with SQL background.</p>

<p>The way this works is that NHibernate ‘compiles’ the HQL query into SQL, and then issues the SQL query (using ADO.NET’s facilities) to the DB.</p>

<p>Sounds pricey?</p>

<p>enter Named Queries.</p>

<p>now these are HQL (or SQL) queries, each has a name (obviously), that are been supplied to NH through the mapping. The queries are being translated and cached as IDbCommand objects as part of the framework initialisation, which mean that you get rid of the HQL-&gt;SQL overhead throughout the life of the process.</p>

<p>One other major benefit, is that the mechanism to actually execute these named queries, does not differentiate between HQL and SQL queries (for the simple fact that these queries have already been transferred to SQL at runtime). That gives you the possibility to replace HQL queries into tighter SQL queries (with the same parameters and which returns the same resultset) should your DBA figure out a better one.</p>

<p>But if you’re using ActiveRecord, you usually do not have direct access into the mapping (.hbm) files. So how would you use named queries with AR?</p>

<p>enter HqlNamedQueryAttribute (not such a great name, as I did state that it would also work for SQL queries).</p>

<p>So, for an example, on this blog’s source code, within PostRepository.cs you’d see this code:</p>

<p>```</p>

<p>…</p>

<h1 id="region-queriesassembly-hqlnamedqueryqueriesfindpostsinarchive-queriesfindpostsinarchiveassembly-hqlnamedqueryqueriesfindbyurlfriendlytagname-queriesfindbyurlfriendlytagnamenamespace-kenegozicomdomain-internal-partial-class-queries--internal-const-string-findpostsinarchive---from-post-p-where--yearplifecyclecreationdate--year-and-monthplifecyclecreationdate--month--order-by-plifecyclecreationdate-desc-internal-const-string-findbyurlfriendlytagname---select-p--from--post-p--join-ptags-t-where-turlfriendlyname-like-urlfriendlytagname-order-by-plifecyclecreationdate-desc-endregion">region queries[assembly: HqlNamedQuery(Queries.FindPostsInArchive, Queries.FindPostsInArchive)][assembly: HqlNamedQuery(Queries.FindByUrlFriendlyTagName, Queries.FindByUrlFriendlyTagName)]namespace KenEgozi.Com.Domain{ internal partial class Queries { internal const string FindPostsInArchive = @” from Post p where  year(p.Lifecycle.CreationDate) = :year and month(p.Lifecycle.CreationDate) = :month  order by p.Lifecycle.CreationDate desc”; internal const string FindByUrlFriendlyTagName = @” select p  from  Post p  join p.Tags t where t.UrlFriendlyName like :urlFriendlyTagName order by p.Lifecycle.CreationDate desc;”; }}#endregion</h1>

<p>…</p>

<p>public ICollection<post> FindInArchive(int year, int month) { </post></p>

<p>return session .GetNamedQuery(Queries.FindPostsInArchive) .SetParameter(“year”, year) .SetParameter(“month”, month) .List<post>(); }</post></p>

<p>…</p>

<p>```</p>

<p>Queries class is marked as partial, as other queries might be presented on other repositories or services that would need to add more named queries. I considered grouping of queries into groups by the using repository, or by aggregate roots, but the thing is - having all of the queries under the same namespace helps discoverability, and helps with preventing duplications</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2008/03/04/the-strength-to-document-the-complex">The strength to document the complex</a></h2>
    <div class="meta">
        <time>on March 4, 2008</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            
            
        </span>
        
    </div>
    
     <p>Another funny quote from Castle dev list:</p>

<p>Ayende (after a discussion on the lack of DynamicProxy documentation):Yes, the underlying assumption that by the time you are done understanding DP you don’t have the strength to write docs.</p>

<p>If you wanna grok that, then you can look at a small snippet from DP2 code on the blog’s title, or <a href="http://svn.castleproject.org:8080/svn/castle/trunk/Tools/Castle.DynamicProxy2/">browse the repo</a></p>


    </section>


  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2008/03/02/documenting-castle-or-thank-you-symon-rottem">Documenting Castle, or Thank you Symon Rottem</a></h2>
    <div class="meta">
        <time>on March 2, 2008</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/miscellanea" rel="tag">miscellanea</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            
            
        </span>
        
    </div>
    
     <p>We, at Castle, are occasionally getting bashed at the lack of documentation. I think that the area most users are complaining about is Windsor and MonoRail, (as these two are evolving in the most rapid way).</p>

<p>My personal view on the matter is that since the whole Castle stack, and especially MonoRail and Windsor, are all about “zero friction” and “Convention over Configuration”, the easiest way is to lay hands on sample or oss code and apply that you your solution.</p>

<p>Anyway, in the Alt.NET uk thing that was at Conchango/London last month I’ve met one Symon Rottem. It appear that this guy know his way around tech-docs, and he had picked up that errand, and <a href="http://blog.symbiotic-development.com/2008/03/02/open-source-documentation/">started putting effort</a> in improving the overall documentation level for Castle, especially the User-Manual part (as the <a href="http://api.castleproject.org">API</a> actually is being generated and is quite good).</p>

<p><a href="http://blog.symbiotic-development.com/">I’d also recommend his (young yet promising) blog</a>. It’s on my Google-reader blogroll for quite some time, and I really need to add “Import OPML” to my blog so I’d be able to update the blogs list on the side panel here.</p>


    </section>


  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2008/03/01/windsor-mass-component-registration">Windsor - Mass Component Registration</a></h2>
    <div class="meta">
        <time>on March 1, 2008</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            
            
        </span>
        
    </div>
    
     <p>It’s so awesome.</p>

<p>I have about 1 minute for that, and the code is very self explanatory, so Im just doing a Copy&amp;Paste from the Castle dev list:</p>

<p>Craig Neuwirt:</p>

<p>The recent changes to the kernel registration interface allows for custom registration strategies. I just added an AllTypesOf strategy to allow for the most common scenarios. Here are some examples:<br />
- Registering all controllers in the current assembly 
<code>
kernel.Register( AllTypesOf&lt;IController&gt; .FromAssembly( Assembly.GetExecutingAssembly() ) );
</code></p>

<ul>
  <li>
    <p>selecting the first interface as the service
<code>
kernel.Register( AllTypesOf&lt;ICommon&gt; .FromAssembly(Assembly.GetExecutingAssembly() ) .WithService.FirstInterface() );
</code></p>
  </li>
  <li>
    <p>Using custom configuration 
<code>
kernel.Register( AllTypesOf&lt;ICommon&gt; .FromAssembly( Assembly.GetExecutingAssembly() ) .Configure( component =&gt; component.LifeStyle.Transient .Named( component.Implementation.FullName + "XYZ" ) ) );
</code></p>
  </li>
  <li>
    <p>Choosing types if they have a specific attribute (courtesy of LINQ) 
<code>
kernel.Register( AllTypesOf&lt;CustomerChain1&gt; .Pick( from type in Assembly.GetExecutingAssembly().GetExportedTypes() where type.IsDefined(typeof(SerializableAttribute), true) select type ));
</code></p>
  </li>
</ul>

<p>Ayende:</p>

<p>You are taking all the fun out of Binsor :-)</p>


    </section>


  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2008/02/28/executing-plain-ol-sql-in-activerecord-transaction">Executing Plain ol' SQL in ActiveRecord Transaction</a></h2>
    <div class="meta">
        <time>on February 28, 2008</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/activerecord" rel="tag">activerecord</a>
            
            
        </span>
        
    </div>
    
     <p>I’m getting asked for this a lot (lately on the Castle’s usergroup, and on many other occasions)</p>

<p>You friend is <a href="http://api.castleproject.org/html/M_Castle_ActiveRecord_ActiveRecordMediator_Execute.htm">ActiveRecordMediator.Execute</a></p>

<p>So here is a sample:</p>

<p>```</p>

<p>ActiveRecordMediator.Execute(typeof(ActiveRecordBase), delegate (NHIbernate.ISession session, object data){ IDbConnection con = session.Connection; IDbCommand cmd = con.CreateCommand();</p>

<p>// That’s the key part - joining the current AR transaction scope session.Transaction.Enlist(cmd); </p>

<p>// now you have a IDbCommand instance - use it at will</p>

<p>}, null);</p>

<p>```</p>

<p>If you want to create a proper method for handling the delegate instead of the anonymous one, then you can pass data in there (using the third argument) and it would get into the delegate as the “object data” thing.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2008/02/12/castle-docs-help">Castle Docs Help</a></h2>
    <div class="meta">
        <time>on February 12, 2008</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/altnetuk" rel="tag">altnetuk</a>
            
            
        </span>
        
    </div>
    
     <p>Lately there has been some noise around the lack of documentation on the Castle project.</p>

<p>I have expressed my view on the matter on the mailing list, and in short I’d say that having an undocumented feature is way better than not having that feature at all.</p>

<p>During the ALT.NET UK conference, one of the guys approached me and said that he has solid background in technical documentation, and that he is willing to put some effort to that end.</p>

<p>I’m terrible with names, so I forgot his (sorry …), but if it’s you dear reader (or if it’s not you, but you are willing to help with that) then please do contact me should you need any help in kicking it off.</p>

<p>Thanks a bunch,</p>

<p>Ken.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2008/01/17/staticmapgenerator-source-is-available">StaticMapGenerator Source Is Available</a></h2>
    <div class="meta">
        <time>on January 17, 2008</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/asp-net-2-0" rel="tag">asp-net-2-0</a>
            ,&nbsp;
            
            <a href="/blog/tag/tools" rel="tag">tools</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            
            
        </span>
        
    </div>
    
     <p>The Static SiteMap Generator’s home is in Castle Contrib, and it’s named Castle.Tools.StaticMapGenerator</p>

<p>I’ve just commited it to the repository, so it’s at http://svn.castleproject.org:8080/svn/castlecontrib/Castle.Tools.StaticMapGenerator/trunk/</p>

<p>UPDATE (22/06/2008):The source has slightly moved (to a sub folder):<a href="http://svn.castleproject.org:8080/svn/castlecontrib/Tools/Castle.Tools.StaticMapGenerator/">http://svn.castleproject.org:8080/svn/castlecontrib/Tools/Castle.Tools.StaticMapGenerator/</a></p>

<p>I hope to have time soon to blog about the creation of this little tool, and of the usage. Also, expect a binary soon.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2008/01/17/its-my-turn-to-build-an-ioc-container-in-15-minutes-and-33-lines">It's My Turn To Build An IoC Container In 15 Minutes and 33 Lines</a></h2>
    <div class="meta">
        <time>on January 17, 2008</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/architecture" rel="tag">architecture</a>
            ,&nbsp;
            
            <a href="/blog/tag/tools" rel="tag">tools</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            
            
        </span>
        
    </div>
    
     <p>Last night I’ve built a nice new tool called StaticMapGenerator which is used to generate a typed static resources site-map for ASP.NET sites (works for MonoRail, ASP.NET MVC and even WebForms).</p>

<p>I’ll blog about it on a separate post in details.</p>

<p>Since I didn’t want any dependency (but .NET 2.0 runtime) for the generator and the generated code, I couldn’t use Windsor to IoC. That calls for a hand rolled simple IoC implementation</p>

<p><a href="http://www.ayende.com/Blog/archive/2007/10/20/Building-an-IoC-container-in-15-lines-of-code.aspx">Ayende has already done it in 15 lines</a>, but I wanted also to automagically set dependencies and have a simpler registration model.</p>

<p>so I’ve quickly hacked together a configurable DI resolver (a.k.a. IoC container) in 15 Minutes and 33 Lines Of Code. Call me a sloppy-coder, call me whadever-ya-like. It just works.</p>

<p><code>
static class IoC {  static readonly IDictionary&lt;Type, Type&gt; types = new Dictionary&lt;Type, Type&gt;();   public static void Register&lt;TContract, TImplementation&gt;()  { types[typeof(TContract)] = typeof(TImplementation);  }  public static T Resolve&lt;T&gt;()  { return (T)Resolve(typeof(T)); }  public static object Resolve(Type contract) { Type implementation = types[contract];  ConstructorInfo constructor = implementation.GetConstructors()[0];  ParameterInfo[] constructorParameters = constructor.GetParameters();   if (constructorParameters.Length == 0) return Activator.CreateInstance(implementation);  List&lt;object&gt; parameters = new List&lt;object&gt;(constructorParameters.Length);   foreach (ParameterInfo parameterInfo in constructorParameters)  parameters.Add(Resolve(parameterInfo.ParameterType));  return constructor.Invoke(parameters.ToArray()); }}
</code></p>

<p>Ok, I’ve cheated. You’d need using statements too, but you can see that I was generous enough with newlines …</p>

<p>Usage:</p>

<p>Given those:
<code>
public interface IFileSystemAdapter { }public class FileSystemAdapter : IFileSystemAdapter { }public interface IBuildDirectoryStructureService { }public class BuildDirectoryStructureService : IBuildDirectoryStructureService{ IFileSystemAdapter fileSystemAdapter; public BuildDirectoryStructureService(IFileSystemAdapter fileSystemAdapter) { this.fileSystemAdapter = fileSystemAdapter; }
}
</code></p>

<p>You can do that:</p>

<p><code>
IoC.Register&lt;IFileSystemAdapter, FileSystemAdapter&gt;();IoC.Register&lt;IBuildDirectoryStructureService, BuildDirectoryStructureService&gt;(); IBuildDirectoryStructureService service = IoC.Resolve&lt;IBuildDirectoryStructureService&gt;();
</code>
You need not worry about supplying the BuildDirectoryStructureService with an implementation for the service it depends on, but only to register an implementation for that service.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2008/01/07/aspview-and-the-latest-castle-trunk">AspView and the Latest Castle Trunk</a></h2>
    <div class="meta">
        <time>on January 7, 2008</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>Lately there has been a major refactoring work being done on MonoRail, as part of the effort toward a release hopefully later this year. As of today, AspView’s trunk is once again compatible with Castle’s trunk.</p>

<p>As usual, code’s <a href="http://svn.castleproject.org:8080/svn/castlecontrib/viewengines/aspview/trunk/">here</a>, binaries are <a href="http://www.aspview.com/">here</a>.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/12/30/using-layout-from-a-custom-location">Using Layout From a Custom Location</a></h2>
    <div class="meta">
        <time>on December 30, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>It’s been asked on the Castle mailing list, and was implemented for NVelocity (and for Brail too, I think), so now it works on AspView, too.</p>

<p>So, doing:</p>

<p><code>
[Layout("\custom\layout")] public class MyController ...
</code></p>

<p>Would use the template from Views\Custom\Layout.aspx</p>


    </section>


  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/12/30/no-more-null-ref-almost">No More Null Ref (almost)</a></h2>
    <div class="meta">
        <time>on December 30, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>I found out that on many occasions I use stuff like:</p>

<p>```</p>
<aspview:properties>string message = "";</aspview:properties>
<p>```</p>

<p>To avoid the need of:</p>

<p><code>
&lt;% = message ?? "" %&gt;
</code></p>

<p>That’s it.</p>

<p>From now on, null values would just be ignored.</p>

<p>Notice that it won’t help you on</p>

<p>&lt;%=post.Blog.Title %&gt; if post.Blog is null …</p>


    </section>


  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/12/30/new-features-for-the-new-year">New Features For The New Year</a></h2>
    <div class="meta">
        <time>on December 30, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>In a good timing for the new year, I’m happy to announce new features to AspView.</p>

<p>I have dedicated a post for each so I’d have a way to reference those features, and for my dear readers to comment on each feature.</p>

<p>So, what’s all the fuss about?
- Nested layouts <a href="http://kenegozi.com/Blog/2007/12/30/nested-layouts.aspx">http://kenegozi.com/Blog/2007/12/30/nested-layouts.aspx</a>
- New syntax for html encoded output <a href="http://kenegozi.com/Blog/2007/12/30/html-encoded-output-in-view-templates.aspx">http://kenegozi.com/Blog/2007/12/30/html-encoded-output-in-view-templates.aspx</a>
- Embedded script blocks inside a view<a href="http://kenegozi.com/Blog/2007/12/30/embedded-script-blocks.aspx">http://kenegozi.com/Blog/2007/12/30/embedded-script-blocks.aspx</a>
- Layouts from custom locations<a href="http://kenegozi.com/Blog/2007/12/30/using-layout-from-a-custom-location.aspx">http://kenegozi.com/Blog/2007/12/30/using-layout-from-a-custom-location.aspx</a>
- Not throwing on null-ref in &lt;%= %&gt; blocks<a href="http://kenegozi.com/Blog/2007/12/30/no-more-null-ref-(almost).aspx">http://kenegozi.com/Blog/2007/12/30/no-more-null-ref-(almost).aspx</a></p>

<p>Downloads, as always, are from <a href="http://www.aspview.com">www.aspview.com</a></p>


    </section>


  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/12/30/nested-layouts">Nested Layouts</a></h2>
    <div class="meta">
        <time>on December 30, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>A cool feature, repeatedly asked for by users (of AspView, and of MonoRail in general).</p>

<p>When stating the layout name in the controller, you use a comma separated list of layouts to be applied, from the most general (outer) inward.</p>

<p>Example:</p>

<p>in the controller:</p>

<p><code>
[Layout("Site, Admin")]public class UsersController : SmartDispatcherController{ public void Index() { }}
</code></p>

<p>and given those schematic templates:</p>

<ul>
  <li>(layouts\site.aspx):<img src="http://kenegozi.com/Blog/uploaded/WindowsLiveWriter/NestedLayouts_104EF/78a6d860-81fe-4660-af25-0e99db002a10.png" alt="SiteLayout" /></li>
  <li>(layouts\admin.aspx)<img src="http://kenegozi.com/Blog/uploaded/WindowsLiveWriter/NestedLayouts_104EF/b49097cb-8d59-4cd2-a6cf-335efdc787d2.png" alt="AdminLayout" /></li>
  <li>(users\index.aspx)<img src="http://kenegozi.com/Blog/uploaded/WindowsLiveWriter/NestedLayouts_104EF/c8f9a805-5caf-4448-82ad-1e30a5542230.png" alt="Index" /> </li>
</ul>

<p>We’d get:</p>

<p><img src="http://kenegozi.com/Blog/uploaded/WindowsLiveWriter/NestedLayouts_104EF/684e8604-0bdd-46be-b9fe-b6433e527f3a.png" alt="rendered view" /></p>


    </section>


  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/12/30/html-encoded-output-in-view-templates">Html Encoded Output In View Templates</a></h2>
    <div class="meta">
        <time>on December 30, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>The existing &lt;%= %&gt; syntax would keep output the raw strings, so it can be used to output properties that has markup inside, like CMS data, the ViewContents in layouts, CaptureFor data, etc.</p>

<p>If you want http encoded output, use &lt;%# %&gt; or ${} instead.</p>

<p>Example:</p>

<p>Given the following view template:</p>

<p><code>
&lt;%string markup = "&lt;span&gt;";%&gt;&lt;%=markup%&gt;&lt;%#markup%&gt;${markup}
</code></p>

<p>The rendered output would be:</p>

<p><code>
&lt;span&gt;&amp;amp;lt;span&amp;amp;gt;&amp;amp;lt;span&amp;amp;gt;
</code></p>

<p>Have fun.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/12/30/embedded-script-blocks">Embedded Script Blocks</a></h2>
    <div class="meta">
        <time>on December 30, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>Say you want to have the possibility to create a method to work in views.</p>

<p>for the sake of argument, let it be:</p>

<p><code>
public string DoubleId(string s){ return s + s;}
</code></p>

<p>your options:
- Create a Helper class and put it there </p>

<ul>
  <li>Create a base class and put it there</li>
</ul>

<p>But what if it’s simple enough (so you won’t need a unit-test) and it’s not supposed to be reused (so creating a Helper/Base class is an overkill)?</p>

<p>Now you can put it directly in your view template, and this is how:</p>

<p><code>
&lt;script runat="server"&gt;public string DoubleId(string s){ return s + s;}&lt;/script&gt;Regular view code&lt;%=DoubleIt(view.Name) %&gt;
</code></p>

<p>Now the devil advocates would say that “Logic In View Is Evil”. And I would concur. But it’s not actually logic. It’s supposed to be used for view-related string manipulations and such. And anyway you can do Evil Deeds without it, too. And you don’t HAVE to use it if you don’t want to.</p>

<p>The idea (and 99% of implementation) is by Gauthier Segay. Thanks dude !</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/12/21/xss-httpencode-aspview-and-being-secure-by-default">XSS, HttpEncode, AspView and being Secure By Default</a></h2>
    <div class="meta">
        <time>on December 21, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/architecture" rel="tag">architecture</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>If you know not what XSS is or how easily you can expose your application to XSS, take a short read at the next posts:</p>

<ul>
  <li><a href="http://damieng.com/blog/2007/12/10/how-dangerous-is-html-injection">http://damieng.com/blog/2007/12/10/how-dangerous-is-html-injection</a></li>
  <li><a href="http://damieng.com/blog/2007/12/18/5-signs-your-aspnet-application-may-be-vulnerable-to-html-injection">http://damieng.com/blog/2007/12/18/5-signs-your-aspnet-application-may-be-vulnerable-to-html-injection</a></li>
  <li><a href="http://blog.wekeroad.com/2007/12/19/in-which-we-discuss-html-encoding/">http://blog.wekeroad.com/2007/12/19/in-which-we-discuss-html-encoding/</a></li>
</ul>

<p>AspView was written by me, for my (and my employer at the time) use. Therefore, I did not make it ‘secure by default’ in terms of HttpEncode.</p>

<p>However, seeing now that the convention lean toward outputing HtmlEncode-ed by default, I’m adapting AspView to that.</p>

<p>The usage would be similar to the one suggested for Asp.NET MVC at <a href="http://blog.codeville.net/2007/12/19/aspnet-mvc-prevent-xss-with-automatic-html-encoding/">http://blog.codeville.net/2007/12/19/aspnet-mvc-prevent-xss-with-automatic-html-encoding/</a></p>

<p>So, </p>

<p><code>
&lt;%="&lt;tag&gt;" %&gt; 
</code></p>

<p>would output </p>

<p><code>
&amp;amp;lt;tag&amp;amp;gt;
</code></p>

<p>While</p>

<p><code>
&lt;%=RawHtml("&lt;tag&gt;") %&gt;
</code></p>

<p>would output </p>

<p>```</p>
<tag>
```



The only exception here is ViewContents on layouts. since the view contents is 99% of the times made of markup, so in the layout would still write:

```
&lt;%=ViewContents %&gt; 
```



All of that stuff is being implemented with AspView trunk (versions 1.0.4.x) that works with Castle trunk.

If anyone wishes me to bubble it down to the 1.0.3.x branch (for Castle RC3), please leave your comments here. Unless I'll see that people actually want that I would probably not make the effort.



</tag>

    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/12/13/new-stuff-in-aspview">New stuff in AspView</a></h2>
    <div class="meta">
        <time>on December 13, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>I’m pleased to announce that the first step of AspView refactoring is over. The pre-compilation process is now way more coherent and easy to follow and to test. Soon enough, as I’ll complete adding a service locator to the mix, it would also be easily extensible.</p>

<p>What can you do now that you couldn’t have done before? Use a custom base class for views.</p>

<p>For example: let’s say that you have created a supercool helper. You’d probably name it SuperCoolHelper. Now you register that helper on the controller:</p>

<p>```
[Helper(typeof(SuperCoolHelper))]public class MyController …</p>

<p>```</p>

<p>You can, ofcourse declare it on every view:</p>

<p>```</p>
<aspview:parameters>&lt;%SuperCoolHelper SuperCoolHelper;%&gt;</aspview:parameters>
<p>&lt;%=MyCoolHelper.CoolStuff() %&gt;
```</p>

<p>You can also use the DictionaryAdapter and add the helper to the base view interface:</p>

<p>```</p>

<p>public interface IView{ SuperCoolHelper SuperCoolHelper { get; set; }}</p>

<p>…&lt;% Page Language=”C#” Inherits=”Castle.MonoRail.Views.AspView.ViewAtDesignTime<iview>" %&gt;</iview></p>

<p>…&lt;%=view.MyCoolHelper.CoolStuff() %&gt;</p>

<p>```</p>

<p>But now you can create a base class for the view:</p>

<p>The base class:</p>

<p><code>
public class MyView : AspViewBase{ SuperCoolHelper SuperCoolHelper { get { return (SuperCoolHelper)Properties["SuperCoolHelper"]; } }}
</code></p>

<p>A mocked class that inherit from Web.UI.Page to make intellisense play nicely:</p>

<p><code>
public class MyViewAtDesignTime : ViewAtDesignTime{ SuperCoolHelper SuperCoolHelper { get { throw new NotImplementedException("useless"); } }}
</code></p>

<p>and in the view:</p>

<p><code>
&lt;% Page Language="C#" Inherits="MyViewAtDesignTime" %&gt;...&lt;%=MyCoolHelper.CoolStuff() %&gt;
</code></p>

<p>You can mix that with the DictionaryAdapter integration:</p>

<p>```
&lt;% Page Language=”C#” Inherits=”MyViewAtDesignTime<ipostview>" %&gt;...
&lt;%=MyCoolHelper.CoolStuff(view.Post.Title) %&gt;</ipostview></p>

<p>```</p>

<p>As usual: <a href="http://www.aspview.com">http://www.aspview.com</a></p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/12/04/aspview-refactoring-status">AspView refactoring status</a></h2>
    <div class="meta">
        <time>on December 4, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>77 tests, all green.</p>

<p>That’s all new tests from the last week.</p>

<p>I think it’s almost stable enough for releasing it on aspview.com</p>

<p>I’ll just put the old tests back in (with Ignore) as regression tests, until I’m comfortable enough to remove.</p>

<p>So - custom base classes for views are just around the corner.</p>

<p>Right after that - better extensibility (through custom Pre Compilation Steps provider and MarkupTransformation Provider)</p>

<p>you can of course watch the progress on svn (it’s all on the trunk, so if you’re using trunk for production, please restrain yourself a few more days …)</p>

<p>stay tuned …</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/11/27/using-the-codegenerator-and-the-dictionaryadapter">Using the CodeGenerator and the DictionaryAdapter</a></h2>
    <div class="meta">
        <time>on November 27, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/tools" rel="tag">tools</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>Following users requests, I have just posted two documents to using.castleproject.org.</p>

<p>The first is an explanation about the CodeGenerator (from Contrib), and another one, on using the DictionaryAdapter.</p>

<p>Here are the links:</p>

<ul>
  <li><a href="http://using.castleproject.org/display/Contrib/Castle.Tools.CodeGenerator">http://using.castleproject.org/display/Contrib/Castle.Tools.CodeGenerator</a></li>
  <li><a href="http://using.castleproject.org/display/Comp/Castle.Tools.DictionaryAdapter">http://using.castleproject.org/display/Comp/Castle.Tools.DictionaryAdapter</a></li>
</ul>

<p>Related stuff:</p>

<ul>
  <li><a href="http://kenegozi.com/Blog/2007/10/16/typed-session-using-castle-components-dictionaryadapter.aspx">A post about using the DictionaryAdapter in ASP.NET</a></li>
  <li><a href="http://kenegozi.com/Blog/2007/10/17/typed-view-properties-in-monorail-and-aspview.aspx">A post about using the Typed Views option in AspView</a></li>
</ul>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/11/20/screen-cast-creating-monorailaspview-web-application-from-scratch">Screen Cast - Creating MonoRail-AspView Web Application From Scratch</a></h2>
    <div class="meta">
        <time>on November 20, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/visual-studio" rel="tag">visual-studio</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>Following many requests from users, I’ve created a screen cast in which I show how to setup a new MonoRail/AspView website, from scratch (no wizards).</p>

<p><a href="http://kenegozi.com/Blog/Files/download.aspx?filename=CreatingMonoRailAspViewWebProjectFromScratchinVisualStudioExpress.wmv">CreatingMonoRailAspViewWebProjectFromScratchinVisualStudioExpress.wmv</a></p>

<p>On that demo, I’ve used Visual Web Developer 2008 Express and Visual C# 2008 Express, both in Beta2, just to show how you can simulate some of the “Web Application Project” experience in the Express editions. Of course it’s much easier to work with a full Visual Studio with Web Application Project as you then have everything in a single application, and it’s easier to handle.</p>

<p>Nothing on the demo is 2008 specific, and it runs on .NET 2.0, so VS2005 would do just fine here.</p>

<p>The demo is very simple, and I have generally just showed a “Hello World” level of setup. I hope to spare some time to follow up with setting up things like Windsor Integration, the Castle.Tools.CodeGenerator, and other cool stuff.</p>

<p>The links I use on the demo are:</p>

<ul>
  <li><a href="http://using.castleproject.org/display/Contrib/Castle.MonoRail.Views.AspView">AspView on using.castleproject.org</a></li>
  <li><a href="http://using.castleproject.org/display/Contrib/Minimal+Web.Config+for+MonoRail+with+AspView">Minimal web.config for AspView/MonoRail</a></li>
</ul>

<p>I’ve used Windows Media Encoder to capture the screen, and my SHURE SM58 mic to record the narrating. It’s a great mic, however plugged into my sorry excuse for a sound-card. </p>

<p>It’s my first screen cast, and I’d love to hear comments from you people, both on the content and on the presentation.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/11/18/activerecord-dot-linq-naive-but-working">ActiveRecord.Linq - naive but Working</a></h2>
    <div class="meta">
        <time>on November 18, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/c-sharp" rel="tag">c-sharp</a>
            ,&nbsp;
            
            <a href="/blog/tag/linq" rel="tag">linq</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/activerecord" rel="tag">activerecord</a>
            ,&nbsp;
            
            <a href="/blog/tag/nhibernate" rel="tag">nhibernate</a>
            
            
        </span>
        
    </div>
    
     <p>I’ve spent some times lately with Linq To SQL and have played a bit with the Mapping namespace.</p>

<p>Why I do not like it very much is a matter for a different post. The matter at hand is that I want the power of Linq, and I want the power of NHibernate, and I want the easy road of ActiveRecord.</p>

<p>What do I mean by that? I’d like:
- query language == Linq<br />
- persistence engine == NHibernate<br />
- Mapping == ActiveRecord attributes </p>

<p>the needed prequisites:
- Linq (framework =&gt; framework.Version &gt;= 3.5)<br />
- <a href="http://www.hookedonlinq.com/LINQToNHibernate.ashx">NHibernate.Linq</a> (source =&gt; source.getFrom(Rhino-Tools) )<br />
- Linq for ActiveRecord - Keep on Reading </p>

<p>So, <a href="http://www.ayende.com">Ayende</a> has kick-started it, and with some help from <a href="http://blogs.magiconsoftware.com/blogs/bdiaz/">Bobby Diaz</a>, we have a prototype level NHibernate provider for Linq.</p>

<p>To make it work with ActiveRecord, all you need is to add:</p>

<p><code>
using System;using Castle.ActiveRecord;using Castle.ActiveRecord.Framework;using NHibernate;namespace NHibernate.Linq{    public class ActiveRecordContext : NHibernateContext { public ActiveRecordContext() : base(null) { session = GetSession(); }  private ISession GetSession() { ISessionScope scope = SessionScope.Current; if (scope == null) throw new InvalidOperationException("You should be in a SessionScope()"); ISessionFactoryHolder holder = ActiveRecordMediator.GetSessionFactoryHolder(); return holder.CreateSession(typeof(ActiveRecordBase)); } }}
</code></p>

<p>and now you can do stuff like:</p>

<p><code>
using (new SessionScope()){ ActiveRecordContext context = new ActiveRecordContext(); var q =  from c in context.Session.Linq&lt;Category&gt;() select c;  foreach (Category c in q) Console.WriteLine(c.Name); }
</code></p>

<p>Assuming Category has [ActiveRecord] mapping.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/11/13/viewfilter-take-2">ViewFilter - Take 2</a></h2>
    <div class="meta">
        <time>on November 13, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>I’ve been asked lately about the use of the ViewFilter mechanism in AspView.</p>

<p>I’ve once written about it briefly here on my blog, and you can see it at <a href="http://kenegozi.com/Blog/2007/01/08/introducing-viewfilters.aspx">http://kenegozi.com/Blog/2007/01/08/introducing-viewfilters.aspx</a></p>

<p>However, I’ll post another (a bit more realistic) example here.</p>

<p>Scenario: some kind of a CMS thing. You want to present the user with some markup, in both “preview” mode and “Source” modes.</p>

<p>If the server had direct access to the markup in a string literal, things were easy. That usually happens when the markup is to be supplied by an end user, either directly or through a WYSIWYG Html editor. You’d end up with something like:</p>

<p><code>
public interface IContentItem{ public string Markup { get; }}
</code></p>

<p>your view would look like:</p>

<p>```
…</p>
<h3>Preview:</h3>
<div>&lt;%=view.ContentItem.Markup %&gt; </div>
<h3>Source:</h3>
<div>&lt;%=Helpers.Html.HtmlEncode(view.ContentItem.Markup) %&gt; </div>
<p>…</p>

<p>```</p>

<p>easy enough.</p>

<p>However, what if the piece of markup that you want to show, has some view-logic, so you have a template generating the markup from an entity? For example, this blog has a view “Posts/One” that gets a Post entity, and fits it into a single post markup, putting the title in a &lt;h4&gt;, tags in <span> with theit title and href, etc.</span></p>

<p>How can you show the markup source for that?</p>

<p>ViewFilter to the rescue.</p>

<p>In short - A ViewFilter is a way to transform a chunk of a view, using simple manipulations. Do not look for that on other View Engines, as it’s currently an AspView-only feature.</p>

<p>Let’s code our needed filter: </p>

<p><code>
public class HtmlEncodeViewFilter : IViewFilter{ public string ApplyOn(string input) { return HttpUtility.HtmlEncode(input); }}
</code></p>

<p>and in the view:</p>

<p><code>
...&lt;% foreach (Post post in view.Posts) { %&gt;&lt;h3&gt;Preview:&lt;/h3&gt;&lt;subview:.Posts.One post="&lt;%=post %&gt;" &gt; &lt;/subview:.Posts.One&gt;&lt;h3&gt;Source:&lt;/h3&gt;&lt;filter:HtmlEncode&gt; &lt;subview:.Posts.One post="&lt;%=post %&gt;" &gt; &lt;/subview:.Posts.One&gt;&lt;/filter:HtmlEncode&gt;&lt;% } %&gt;
</code></p>

<p>Hey - you won’t even need to create that filter. AspView is supplied with four basic (however useful) filters:</p>

<ul>
  <li>
    <p>HtmlDecodeViewFilter </p>
  </li>
  <li>
    <p>HtmlEncodeViewFilter </p>
  </li>
  <li>
    <p>LowerCaseViewFilter </p>
  </li>
  <li>
    <p>LowerCaseViewFilter </p>
  </li>
</ul>

<p>Can you think of more reusable view filters? why not post them here, or better yet, supply a patch to AspView with you filters?</p>


    </section>


  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/11/13/asp-dot-net-mvc-framework-demo-app-by-scott-guthrie">ASP.NET MVC Framework - Demo App by Scott Guthrie</a></h2>
    <div class="meta">
        <time>on November 13, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>Scott Guthrie is going to present a demo application using the ASP.NET MVC Framework.</p>

<p>First episode is here: <a href="http://weblogs.asp.net/scottgu/archive/2007/11/13/asp-net-mvc-framework-part-1.aspx">http://weblogs.asp.net/scottgu/archive/2007/11/13/asp-net-mvc-framework-part-1.aspx</a></p>

<p>Very interesting. I can already see four things that my current VS2005/MonoRail/AspView/IIS5-6 stack lack.
- I do not have a project template, so setting up a new project take a bit longer than clicking “new MVC project”.
- I do not have default rewrite rules. 
- I cannot use Server Controls.
- Web Designer support when doing views is not too good. Also, layouts are not treated as MasterPages by the IDE</p>

<p>Sounds bad?</p>

<p>Well:
- Since I am not at kinder garden, I do not “play” with setting up new projects. When I start a new project, it would probably last for quite some time. So the time it takes me to copy&amp;paste a minimal web.config, setup a few lines in global.asax.cs, add references and create Controllers and Views folders, costs me about 5 minutes of the global project costs.I can live with that.
- Shame. However, I can add them to my initial web.config/global.asax.cs files that I use as templates for new projects. Again - one-time cost, and not a price-i one.
- I do not want to use those. Didn’t use them even when I was doing WebForms. I’m happy enough with ViewComponents, SubViews and ViewFilters, and I can easily use any cool 3rd party JS controllers (YUI/Dojo/jQuery/ExtJs/Moo/You-Name-It)
- Again - I do not trust WYSIWYG generated markup. It might be good enough for the texts on my personal blog (dear Windows Live Writer - can’t you <br /> instead of <br />? what’s the deal). It is definitely not good enough for any production level web site.</p>

<p>So - all the downsides are taken care of.</p>

<p>Plus, the stack I use is being used in production environment by gazillion people (ok, AspView is not that common, but the ViewEngine is just 5% of the whole stack, and it’s the rock solid part anyway). It is working with .NET 2.0 so I need not convince clients to go for installing .NET 3/3.5 on their shared hosting solution, and since it’s open-source, I can tweak stuff for my needs without the need to wait for a hotfix/ServicePack that might never appear, if not too late.</p>

<p>And if I’m not enough of a jerk for ranting like that, I’m going to try (if I’d have enough time) to put up a sample application using MonoRail/AspView similar to Scott’s, but this time, you would actually be able get the bits and run it on your machines.</p>

<p>Stay tuned.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/11/11/nesting-view-components-in-aspview">Nesting View Components in AspView</a></h2>
    <div class="meta">
        <time>on November 11, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>Following a request from Gauthier Segay, AspView now supports nested view components.</p>

<p>scenarion: you are using CaptureFor to inject markup from a view to a layout, and you want the injected markup to include a view component output.</p>

<p>in the layout:</p>

<p><code>
...&lt;%=CapturedContent %&gt;...
</code></p>

<p>in the view:</p>

<p><code>
...&lt;component:CaptureFor id="CapturedContent"&gt; Some markup &lt;component:SomeFancyStuff&gt;Fancy component content&lt;/component:SomeFancyStuff&gt;&lt;/component:CaptureFor&gt;
</code></p>

<p>While working on that, I found out yet another problem. nested components of same type would brake</p>

<p>so:</p>

<p>```</p>
<component:bold><component:bold>stuff</component:bold></component:bold>
<p>```</p>

<p>would brake.</p>

<p>As you probably might know, the whole preprocessing of view, from AspView syntax to standard C# is done with Regular Expressions. For quickly doing the above, I helped myself to <a href="http://puzzleware.net/blogs/archive/2005/08/13/22.aspx">http://puzzleware.net/blogs/archive/2005/08/13/22.aspx</a> in order to build the balanced tags aware regular expression, and now it works like a charm. <a href="http://weblogs.asp.net/rosherove/">Roy Osherove</a>’s <a href="http://tools.osherove.com/CoolTools/Regulator/tabid/185/Default.aspx">Regulator</a> was helpful, too.</p>

<p>So, as of revision 360 in Castle Contrib repository, nesting view components works (for both the trunk and the RC3 compatible branch)</p>

<p>As usual - go to <a href="http://www.aspview.com">http://www.aspview.com</a> to get the binaries, or to <a href="http://svn.castleproject.org:8080/svn/castlecontrib/viewengines/aspview/">http://svn.castleproject.org:8080/svn/castlecontrib/viewengines/aspview/</a> for the sources.</p>

<p>Cheers.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/11/08/aspview-autorecompilation-mode-is-fully-operational">AspView - AutoRecompilation mode is fully operational</a></h2>
    <div class="meta">
        <time>on November 8, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>If you set autoRecompilation=”true” in your aspview section on web.config, then you need not use the vcompile.exe on every build. The views would get compiled in memory from sources.</p>

<p>Benefits: Change a view source, refresh the browser - viola, you can see he change impact. No need to rebuild the web project, the application is not restarted so no session is lost, and no need for “double refresh”.</p>

<p>Still, when you deploy it’s strongly advised that you’d run VCompile manually, copy the compiledViews.dll to the server, and set autoRecompilation=”false” on the server’s web.config.</p>

<p>The <a href="http://using.castleproject.org/display/Contrib/Castle.MonoRail.Views.AspView">starter tutorial on using.castleproject.org</a> is now updated, and you can download AspView binaries from <a href="http://www.aspview.com">http://www.aspview.com</a></p>

<p>Please use that (and other) new features and leave me some comments please …</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/10/29/new-homepage-for-aspview">New Homepage for AspView</a></h2>
    <div class="meta">
        <time>on October 29, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>I’ve just setup a brand new site for AspView.</p>

<p>It’s main purpose is to aggregate AspView related data to one central location. It would contain links to AspView related posts from this blog and others, links to online documentation and samples.</p>

<p>There’d be also a “download” page containing the latest builds to be used with Castle RC3 and Castle trunk.</p>

<p>The site’s link is (surprise surprise): <a href="http://www.aspview.com">http://www.aspview.com</a></p>


    </section>


  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/10/29/aspview-new-syntax-for-properties-section-breaking-change">AspView - New Syntax for Properties Section (Breaking Change)</a></h2>
    <div class="meta">
        <time>on October 29, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>So, what is Properties Section?</p>

<p>View sources files used to look like this:</p>

<p><code>
&lt;%Page Language= ... %&gt;&lt;% int someProperty;%&gt;... rest of view ...
</code></p>

<p>The problem was that if you had no properties (or have used the DictionaryAdpater option <a href="http://kenegozi.com/Blog/2007/10/17/typed-view-properties-in-monorail-and-aspview.aspx">described here</a>) then you had to have an empty section, like:</p>

<p><code>
&lt;%Page Language= ... %&gt;&lt;%%&gt;... rest of view ...
</code></p>

<p>Which is quite ugly.</p>

<p>So, following Lee Henson’s suggestion,the properties section should now be wrapped in a special tag, and you can just omit that tag if you do not need to declare any properties.</p>

<p>The new syntax (new stuff in <strong>Bold Italic Font</strong>):</p>

<p><code>
&lt;%Page Language= ... %&gt;**&lt;aspView:properties&gt;**&lt;% int someProperty;%&gt;**&lt;/aspView:properties&gt;**... rest of view ...
</code></p>

<p>You can download the new binaries, and a utility to migrate your existing views to the new syntax, from <a href="http://www.aspview.com">http://www.aspview.com</a></p>


    </section>


  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/10/29/aspview-new-syntax-for-passing-parameters-to-subviews-breaking-change">AspView - New Syntax for Passing Parameters to SubViews (Breaking Change)</a></h2>
    <div class="meta">
        <time>on October 29, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>The old syntax for passing parameters to subviews was:</p>

<p>View sources files used to look like this:</p>

<p><code>
&lt;%Page Language= ... %&gt;... blah blah ...&lt;subview:whatever name="value"&gt;&lt;/subview:whatever&gt;
</code></p>

<p>The problem was thatyou could only have passed variables (byname), so if you needed to pass a string literal you had to declare a string object with the literal:</p>

<p><code>
&lt;%Page Language= ... %&gt;... blah blah ...&lt;%string value="literal";  %&gt;&lt;subview:whatever name="value"&gt;&lt;/subview:whatever&gt;
</code></p>

<p>The new syntax follows the syntax for view components, and also the expected scripting syntax.</p>

<p>so now:</p>

<p><code>
&lt;%Page Language= ... %&gt;&lt;%%&gt;&lt;subview:whatever name="mike" age="&lt;%=30%&gt;" currentItem="&lt;%=item%&gt;"&gt;&lt;/subview:whatever&gt;
</code></p>

<p>would pass the string literal <strong>“mike”</strong> to <strong>name</strong>, the int constant <strong>30</strong> to <strong>age</strong>, and the object <strong>item</strong> to <strong>currentItem</strong>.</p>

<p>You can download the new binaries, and a utility to migrate your existing views to the new syntax, from <a href="http://www.aspview.com">http://www.aspview.com</a></p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/10/25/ive-just-been-knighted-as-a-member-of-the-castle">I've just been Knighted as a member of the Castle</a></h2>
    <div class="meta">
        <time>on October 25, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            
            
        </span>
        
    </div>
    
     <p>In one word: Wow.</p>

<p>In a few more: It seam that the Castle Project PMC got tired of me nagging them about some patches, so they’ve decided to make me a commiter.</p>

<p><img src="http://kenegozi.com/Blog/uploaded/WindowsLiveWriter/IvejustbeenKnighted_CA2E/cd0df52e-011f-40a3-98ed-f7dbc6850e2b.png" alt="Ken in Castle" /></p>

<p>I find it very flattering, as this group is made of very talented people, who are maintaining a rather large, sophisticated, extremely useful and widespread set of frameworks and libraries.</p>

<p>I hope I will stand up to the faith they’ve given in me, by contributing Good Stuff into the repository, and help making existing Good Stuff into Great stuff, and Great Stuff into Amazing.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/10/17/typed-view-properties-in-monorail-and-aspview">Typed View Properties in MonoRail and AspView</a></h2>
    <div class="meta">
        <time>on October 17, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/asp-net-2-0" rel="tag">asp-net-2-0</a>
            ,&nbsp;
            
            <a href="/blog/tag/c-sharp" rel="tag">c-sharp</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>Following my last post on the DictionaryAdapter, I’ll demonstrate here how you can get typed access to your views’ properties.</p>

<p>What it requires from you:</p>

<ol>
  <li>
    <p>Declare an interface for each of your views. That is a Good Thing anyway, as designing to a contract is a good best practice, and it allows for easy testing.</p>
  </li>
  <li>
    <p>Have a base class for your controller that would define TypedFlash and TypedPropertyBag. Not mandatory, but very convenient.</p>
  </li>
  <li>
    <p>Use the newest build of AspView. Again - not mandatory, but helpful.</p>
  </li>
</ol>

<p>Now for the showtime.</p>

<p>First we would create a base class for our controllers, with a TypedPropertyBag and TypedFlash properties:</p>

<p><code>
public abstract class Controller&lt;IView&gt; : SmartDispatcherControllerController    where IView : class{    IDictionaryAdapterFactory dictionaryAdapterFactory; IView typedPropertyBag; IView typedFlash; protected IView TypedPropertyBag { get         {             if (typedPropertyBag == null)         typedPropertyBag = dictionaryAdapterFactory.GetAdapter&lt;IView&gt;(PropertyBag);            return typedPropertyBag;         } }  protected IView TypedFlash { get         {             if (typedFlash == null)         typedFlash = dictionaryAdapterFactory.GetAdapter&lt;IView&gt;(Flash);            return typedFlash;         } }  protected override void Initialize() { base.Initialize();        IDictionaryAdapterFactory dictionaryAdapterFactory = new DictionaryAdapterFactory(); }}
</code></p>

<p>tip:</p>

<p>You can look at a <a href="http://using.castleproject.org/display/Contrib/Castle.Tools.CodeGenerator">more complete version of that base-class</a>, written by Lee Henson (who have made some improvements to the original DictionaryAdapter, and also have introduced me to <a href="http://www.peroniitaly.com/">Peroni Beer</a>).The base controller also declares a type parameter for a Session DictionaryAdapter, hooks into the Castle.Tools.CodeGenerator, and uses IoC for DI.Talking about those issues is a separate subject, for other posts.</p>

<p>Now let’s create the view contract. A rather stupid example would be:</p>

<p><code>
public interface IStupidView{ Guid Id { get; set; }    string Name { get; set; }}
</code></p>

<p>controller:</p>

<p><code>
public class StupidController : Controller&lt;IStupidView&gt;{    public void Index()    {    }    public void DoStuff(string name, string password)    {        if (password != "AspView Rocks")        {            TypedFlash.Name = name;            TypedFlash.Message = "Wrong Password";            RedirectToAction("Index");            return;        }        TypedPropertyBag.Id = Guid.NewGuid();        TypedPropertyBag.Name = name;    }}
</code></p>

<p>view (Index.aspx):</p>

<p><code>
&lt;%@ Page Language="C#" Inherits="Castle.MonoRail.Views.AspView.ViewAtDesignTime&lt;IStupidView&gt;" %&gt;&lt;%%&gt;&lt;p&gt;&lt;%=view.Message %&gt;&lt;/p&gt;&lt;form action="DoStuff.rails"&gt;Name: &lt;input type="text" name="name" value="&lt;%= view.Name %&gt;" /&gt; &lt;br /&gt;password: &lt;input type="password" name="password" /&gt; &lt;br /&gt;&lt;input type="submit" /&gt;&lt;/form&gt;
</code></p>

<p>view (DoStuff.aspx):</p>

<p><code>
&lt;%@ Page Language="C#" Inherits="Castle.MonoRail.Views.AspView.ViewAtDesignTime&lt;IStupidView&gt;" %&gt;&lt;%%&gt;The data was: &lt;br /&gt;Id: &lt;%= view.Id %&gt;, Name: &lt;%= view.Name %&gt;
</code></p>

<p>Look at the intellisense (and at my ultra-cool black color scheme):</p>

<p><img src="http://kenegozi.com/Blog/uploaded/WindowsLiveWriter/TypedViewPropertiesinMonoRailandAspView_11288/8d0b77d0-63d6-4e46-b355-c87ae31e5ca4.png" alt="TypedView intellisense" /></p>

<p>Things to notice:</p>

<ol>
  <li>Do not forget to reference the Assembly that has the view interface declaration. On the test site within aspview’s source repository the interface is declared in the Web project (AspViewTestSite), so the web.config has this:</li>
</ol>

<p>view (Index.aspx):</p>

<p><code>
&lt;aspview ... &gt;... &lt;reference assembly="AspViewTestSite.dll"/&gt;...&lt;/aspview&gt;
</code></p>

<ol>
  <li>you can use the DictionaryAdapter directly, on older versions of AspView (and on WebForms aspx/ascx files) by simply grabbing an adapter manually. sample:</li>
</ol>

<p><code>
...&lt;% IMyViewContract view = new Castle.Components.DictionaryAdapter.DictionaryAdapterFactory()       .GetAdapter&lt;IMyViewContract&gt;(Properties); %&gt;...blah blah &lt;%=view.UsefulProperty %&gt;...
</code></p>

<p>Ok, cut the crap. where can I get it?</p>

<p>here (<a href="http://kenegozi.com/Blog/Files/download.aspx?filename=AspView_1.0.3.324_Release.zip">release</a>, <a href="http://kenegozi.com/Blog/Files/download.aspx?filename=AspView_1.0.3.324_Debug.zip">debug</a>, <a href="http://svn.castleproject.org:8080/svn/castlecontrib/viewengines/aspview/trunk/">source</a>)</p>

<p>UPDATE:</p>

<p>The DictionaryAdapter was initially written by the guys from Eleutian as part of Castle.Tools.CodeGenerator. </p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/10/16/typed-session-using-castle-components-dictionaryadapter">Typed Session using Castle.Components.DictionaryAdapter</a></h2>
    <div class="meta">
        <time>on October 16, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/asp-net-2-0" rel="tag">asp-net-2-0</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            
            
        </span>
        
    </div>
    
     <p>The castle project has a little gem hidden within.</p>

<p>Well, it has many of those, but I’ll refer to one of them here.</p>

<p><a href="http://api.castleproject.org/html/N_Castle_Components_DictionaryAdapter.htm">Castle.Components.DictionaryAdapter</a></p>

<p>This is a tool that can generate typed wrapper around any IDictionary, using a POCI (Plain Old CLR Interface) as a contract. The generation occur on runtime, using Reflection.Emit magic.</p>

<p>Ok, assume you have an information system written in ASP.NET ( warning - WebForms code ahead).</p>

<p>You might keep the current username and a user preferences object in the session.</p>

<p>Somewhere along your application, you’d probably have a pieces of code like that:</p>

<p><code>
public static class TypedSession{    private static HttpSessionState session = HttpContext.Current.Session;    public static string Username     {         get { return (string)session["Username"]; }     }    public static Preferences Preferences     {         get { return (Preferences)session["Preferences"]; }     }}
</code></p>

<p>and in your code you’d be able to do:</p>

<p><code>
...    if (TypedSession.Preferences.Color == Color.Red)        helloLabel.Text = "Hello " + TypedSession.Username;...
</code></p>

<p>Now, I won’t get into those arguments, but generally speaking it would be great if you had an interface to encapsulate your session data (for example - it’s good for testing as you can easily mock session data).</p>

<p>So:</p>

<p><code>
public interface ISession{    string Username { get; set; }    Preferences Preferences { get; set; }}
</code></p>

<p>And use it like that:</p>

<p><code>
...    ISession TypedSession = new DictionaryAdapterFactory().GetAdapter&lt;ISession&gt;(Session);...    if (TypedSession.Preferences.Color == Color.Red)        helloLabel.Text = "Hello " + TypedSession.Username;...
</code></p>

<p>You probably want to put the creation of the TypedSession in a base class.</p>

<p>And you’ve probably noticed that the adapter itself is being acquired through an interfacedFactory, so you can easily use your IoC container of choice to plug in specialized implementations on rare edge cases, and also use your Mock framework of choice for easy testing.</p>

<p>On the next post I’ll show you how well that fit into the world of MonoRail and AspView, as the use of dictionaries is wide (PropertyBag and Flash), and using that library + the newest addition to AspView can grant you with a simple, type safe and intellisense friendly view development experience.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/10/08/aspview-for-castle-rc3-new-release">AspView for Castle RC3 - new release</a></h2>
    <div class="meta">
        <time>on October 8, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/tools" rel="tag">tools</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>Although about three weeks too late, I present thee:</p>

<p>AspView, builtfor Castle RC3 (<a href="http://kenegozi.com/Blog/Files/download.aspx?filename=AspView_for_Castle_RC3_Release.zip">release</a>, <a href="http://kenegozi.com/Blog/Files/download.aspx?filename=AspView_for_Castle_RC3_Debug.zip">debug</a>, <a href="http://svn.castleproject.org:8080/svn/castlecontrib/viewengines/aspview/trunk/">source</a>)</p>

<p>I’ve also introduced a well due improvement to the engine. Now it supports the use of a 404 rescue view, that would get rendered in case of the url mapping to a non-existent controller.</p>

<p>the commit comment (for revision 314) says it all:</p>

<p>Handling view creation for EmptyController, specifically when a controller is not found and a 404 rescue exists</p>

<p>Next improvement will include an option for doing AutoRecompilation in memory, as sometimes the IIS process gets hold on the CompiledViews assembly files (dll and pdb) and failing the automatic recompilation process. </p>

<p>I certainly need that as it happens on my machine too much, and building the Web project takes a solid 10-15 seconds, while running vcompile is a milliseconds thing only.</p>

<p>Soon …</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/08/22/some-notes-from-monorailaspview-talk">Some notes from MonoRail/AspView talk</a></h2>
    <div class="meta">
        <time>on August 22, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>Regarding my MonoRail/AspView talk from last week, <a href="http://www.lnbogen.com">Oren Ellenbogen</a> has compiled a list of “things to remember”. </p>

<p>His list <strong>(with my notes)</strong>:</p>

<p>These are my notes about the lecture (as someone who wants to use it in our project at Semingo): </p>

<ol>
  <li>
    <p>DataBind of fields - nice migration from string into classes and vice versa.  </p>
  </li>
  <li>
    <p>Need vcompile.exe in order to compile views.  </p>
  </li>
  <li>
    <p>Cannot use <a href="http://asp.net">asp.net</a>controls. Actually we don’t need it in our project. <strong>(Actually you can use ‘em in MonoRail, if you are using the WebFormsViewEngine, but it hurts the simplicity of MonoRail too much)</strong></p>
  </li>
  <li>
    <p>Routing is a must (think about url structure in our project). <strong>(RoutingHttpModule will do the job)</strong></p>
  </li>
  <li>
    <p>Learn about the mapping process between controllers, views &amp; parameters.  </p>
  </li>
  <li>
    <p>Can use Castle.Validation in order to validate our business objects. <strong>(Sweet)</strong></p>
  </li>
  <li>
    <p>Ask Egozi about client side validation .vs. server side validation in MonoRail. <strong>(Castle.Component.Validation integrates well into prototype’s Real-Easy-Field-Validation, as well as some more js validation libraries)</strong></p>
  </li>
  <li>
    <p>The controller can be injected with outside components (database, services etc) via Windsor, it’s integrated easily. <strong>(Another sweet spot)</strong></p>
  </li>
  <li>
    <p>TDD is easy (controller and view(should we?)), we can mock everything! Don’t forget to call PrepareController method (inside the base class). <strong>(Actually PrepareController is Per Controller, so usually it will be called in [SetUp] of each Fixture)</strong></p>
  </li>
  <li>
    <p>FormHelper &amp; DictHelper should make our life easier. <strong>(and you can build your own Helpers easily)</strong></p>
  </li>
  <li>
    <p>Controller fills PropertyBag(view use it) &amp; Flash (customer messages) – need to define a property in the view (make it string.Empty as default, if Flash[“property_name”] wasn’t filled).  </p>
  </li>
  <li>
    <p>Use Flash property (dictionary) and RedirectToReferrer method to “refresh” page.  </p>
  </li>
  <li>
    <p>Layout[“X”] – like master page! <strong>(I wouldn’t say “like MasterPage” as it’s just a simple ol’ view, but it gives you a common markup frame for your views, in a similar way of a WebForms’ MasterPage)</strong></p>
  </li>
  <li>
    <p>ViewComponent – like a custom control (without the dark magic of <a href="http://asp.net">asp.net</a>) but contains only UI rendering logic. </p>
  </li>
  <li>
    <p>component:CaptureFor -&gt; we can use it to add javascripts, css files into the html header in the “master page”. <strong>(dude - It’s a Layout, not a MasterPage ;) )</strong></p>
  </li>
  <li>
    <p>We can override the “default” render of the controls via sections in the markup (define sections will override it). <strong>(dude - It’s a component, not a control;) )</strong></p>
  </li>
  <li>
    <p>Egozi uses prototype (pasha as well?) as ajax framework. For Ajax – call CancelLayout method and RenderView(“name_of_view”). This is called SubView and we use it in the markup with <subview:name_of_view></subview:name_of_view>. <strong>(Actually I tend to use prototype as a Javascript enhancement, where needed. If only ‘ajax’ calls are needed, jQuery or YAHOO.connection would be a better lightweight solution)</strong></p>
  </li>
  <li>
    <p>We can use the Cache attribute (MonoRail) over the controller method (aka “Action”) in order to avoid cacheability of urls (like Response.Exired = DateTime.Now.AddDays(-1) or something like this). <strong>(You can also use Response.Cache as before, the attribute makes our code nicer)</strong></p>
  </li>
  <li>
    <p>We can use Filter for authentication – read about it a little. Each action on the controller will trigger this before running (or after).  </p>
  </li>
  <li>
    <p>PropertyBag uses string, eleutian solved it with a smart code generator (pre-build). Create typed Flash and PropertyBag if implementing interfaces. Read about it (ask Egozi for link). <strong>(it’s in **<a href="http://svn.castleproject.org:8080/svn/castlecontrib/codegenerator/trunk/">Castle.Tools.CodeGenerator on CastleContrib</a></strong>, and also look at <strong><a href="http://blog.eleutian.com/">their blog</a></strong>. The tool actually is being used for typing of your site’s Controllers, Actions, and Views. As a side effect, they have created <a href="http://svn.castleproject.org:8080/svn/castle/trunk/Components/General/DictionaryAdapter/">DictionaryAdapter</a> than can do the IDictionary&lt;-&gt;TypedObject thing.And yuu can also hand-type PropertyBag and Flash.)**</p>
  </li>
</ol>

<p>Thanks Oren.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/08/18/slides-and-zips-from-monorail-aspview-talk">Slides and Zips From MonoRail / AspView Talk</a></h2>
    <div class="meta">
        <time>on August 18, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>Ok. After some delay (couldn’t get Internet Connection at my mother in-law’s house), here are the links from my MonoRail / AspView talk:</p>

<ol>
  <li>
    <p><a href="http://kenegozi.com/Blog/Files/download.aspx?filename=MonoRail-AspView-Presentation.zip">The slides</a> (used the newly released StarOffice from Google Apps. Should show ok in Powerpoint)</p>
  </li>
  <li>
    <p><a href="http://kenegozi.com/Blog/Files/download.aspx?filename=AspView-for-castle-rev4016-build472.zip">A zip file</a>, containing AspView built against MonoRail from revision 4016 (build no. 472), including a skeleton web project (as shown on my talk), the minimal castle dll’s needed to run the skeleton project and links to Castle’s build server (to get the full castle libraries) and to my blog.</p>
  </li>
</ol>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/07/12/monorail-aspview-talk-on-august-15th">MonoRail / AspView talk on August 15th</a></h2>
    <div class="meta">
        <time>on July 12, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>I’m going to give a talk about MonoRail (and AspView, of course), on the next <a href="http://www.comconix.com/ivcug/">C# UserGroup meeting</a>, at Microsoft Israel offices in Raanana.</p>

<p>If you’re interested in a solid MVC implementation for web development, that leverages all the goodies of ASP.NET, without the complications of WebForms - this talk is for you.</p>

<p>I’ll brief over “what is MVC” , and then will demonstrate some of MonoRail’s features that can help you build web applications in a way that is easy, expressive, testable and fun. I’ll also demonstrate how to create a full MonoRail/AspView application from scratch, using trunk versions, as this is something that many people ask for on the Castledev and user lists, and on my email’s Inbox, too.</p>

<p>If you have any ideas/question about MonoRail or AspView, that you’d like me to address during that talk, please drop a comment here or to my email, and I’ll try to make room for that in my talk.</p>

<p>Admission is free, and you may attend without reserving a place.</p>

<p>However, the group admins kindly request that you notify them if you plan to attend so that they can be sure to have enough chairs and FOOD!</p>

<p>Contact them through the <a href="http://www.comconix.com/ivcug/">usergroup’s webpage</a>.</p>

<p>See ya.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/07/08/checkbox-grids-in-monorail">Checkbox Grids in MonoRail</a></h2>
    <div class="meta">
        <time>on July 8, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/asp-net-2-0" rel="tag">asp-net-2-0</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>Referring <a href="http://weblogs.asp.net/jgalloway/archive/2007/07/07/checkbox-grids-in-asp-net.aspx">Jon Galloway’s post</a>, here is my 5-minute-scracth-up-somthing that includes no hacking at all:</p>

<p>The Controller:</p>

<p><code>
publicclassGourmetController : SmartDispatcherController
    {
        [AccessibleThrough(Verb.Get)]
        publicvoid WineMatch()
        {
            PropertyBag["matches"] = FoodAndWineMatchRepository.FindAll();
        }
        [AccessibleThrough(Verb.Post)]
        publicvoid Update([DataBind("matches")]FoodAndWineMatch[] matches)
        {
            FoodAndWineMatchRepository.UpdateAll(matches);
            RedirectToAction("WineMatch");
        }
    }
</code></p>

<p>The View:</p>

<p>```
&lt;%@PageLanguage=”C#”%&gt;
&lt;%@ImportNamespace=”Gourmet”%&gt;
&lt;%
    FoodAndWineMatch[] matches;
%&gt;
&lt;%
    IDictionary @checked = DictHelper.CreateDict(“checked=’checked’”);
%&gt;
&lt;formaction=”Update.aspx”method=”post”&gt;</p>
<table>
<tr>
<th>Food Name</th>
<th>Cabarnet</th>
<th>Zinfandel</th>
<th>Pinot</th>
</tr>
&lt;%int i = 0; %&gt;
&lt;%foreach (FoodAndWineMatch match in matches)  { %&gt;
<tr>
<td>
<span>&lt;%=match.FoodName%&gt;</span>
&lt;inputtype="hidden"name="matches[&lt;%=i%&gt;].FoodName"value="&lt;%=matches[i].FoodName%&gt;"/&gt;
</td>
<td>
&lt;%=FormHelper.CheckboxField("matches[" + i + "].MatchesCabarnet", matches[i].MatchesCabarnet?@checked:null)%&gt;
</td>
<td>
&lt;%=FormHelper.CheckboxField("matches[" + i + "].MatchesZinfandel", matches[i].MatchesZinfandel?@checked:null)%&gt;
</td>
<td>
&lt;%=FormHelper.CheckboxField("matches[" + i + "].MatchesPinot", matches[i].MatchesPinot?@checked:null)%&gt;
</td>
</tr>&lt;%++i; } %&gt;
<tr>
&lt;tdcolspan="4"&gt;
&lt;inputtype="submit"value="Save"/&gt;

</tr>
</table>
<p>&lt;/form&gt;</p>

<p>```</p>

<p>And the mocked “domain objects”:</p>

<p>```
publicclassFoodAndWineMatch
    {
        privatestring foodName;
        privatebool matchesCabarnet;
        privatebool matchesPinot;
        privatebool matchesZinfandel;</p>

<pre><code>    public FoodAndWineMatch() { }
    public FoodAndWineMatch(string foodName)
        :
        this(foodName, false, false, false) { }
    public FoodAndWineMatch(string foodName,
                            bool matchesCabarnet,
                            bool matchesPinot,
                            bool matchesZinfandel)
    {
        this.foodName = foodName;
        this.matchesCabarnet = matchesCabarnet;
        this.matchesZinfandel = matchesZinfandel;
    }

    publicstring FoodName
    {
        get { return foodName; }
        set { foodName = value; }
    }

    publicbool MatchesCabarnet
    {
        get { return matchesCabarnet; }
        set { matchesCabarnet = value; }
    }

    publicbool MatchesPinot
    {
        get { return matchesPinot; }
        set { matchesPinot = value; }
    }

    publicbool MatchesZinfandel
    {
        get { return matchesZinfandel; }
        set { matchesZinfandel = value; }
    }
}
publicstaticclassFoodAndWineMatchRepository
{
    privatestaticFoodAndWineMatch[] _matches = null;
    publicstaticFoodAndWineMatch[] FindAll()
    {
        if (_matches == null)
            _matches = newFoodAndWineMatch[] {
            newFoodAndWineMatch("Salmon"),
            newFoodAndWineMatch("Steak"),
            newFoodAndWineMatch("Chicken"),
            newFoodAndWineMatch("Chocolate")
        };
        return _matches;
    }
    publicstaticvoid UpdateAll(FoodAndWineMatch[] matches)
    {
        _matches = matches;
    }
}
</code></pre>

<p>```</p>

<p>No hacking needed. Controller code is short and intuitive. </p>

<p>Oh. No postback for every client click …</p>

<p>I especiallyliked one of the comments on Jon’s post:</p>

<p>I love ASP.NET because of tricks like this that the developer can use.</p>

<p>Well, Ido not likeWebForms <strong>because</strong> it makes me “do tricks” (or hack) instead of bringing business value.</p>

<p>So I do not mean that Jon’s “hack” is bad. That’s what you have to do when you’re WebForm-ing. I just say that there are other web development frameworks (actually, all but WebForms) that are more suited for reasonable html generation and for dealing with the http protocol.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/07/06/summing-up-the-last-two-and-a-half-years-bye-bye-sqlink">Summing up the last two and a half years - Bye bye SQLink</a></h2>
    <div class="meta">
        <time>on July 6, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/activerecord" rel="tag">activerecord</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            ,&nbsp;
            
            <a href="/blog/tag/hql" rel="tag">hql</a>
            ,&nbsp;
            
            <a href="/blog/tag/personal" rel="tag">personal</a>
            
            
        </span>
        
    </div>
    
     <p>It was absolutely brilliant.</p>

<p>I started to work for SQLink on late December 2005 as a Team Leader in the Web Projects Department.</p>

<p>Colleaged by <a href="http://www.lnbogen.com">Oren Ellenbogen</a>, it has been a pleasure. Our department head, Moti, was doing the best he can to create a very likeable working environment, and all our developers were enjoing a workplace that enabled them to learn a lot. Oren and I were directing all kinds of sessions with the developers, showing them stuff about .NET and the CLR, from “what are nullables”, through “What does the ‘using’ reserved word mean”, to “how the GC is actually working”.</p>

<p>We have built this great website called <a href="http://www.gotfriends.co.il">GotFriends</a>, that gave the company a great new source for recruiting new employees, and actually is ground breaking in the Israeli HR world. Building that site, we’ve used many technologies to make it work smoothly with the company’s inner legacy HR system, and with the aid of the SQL master Moran Benisty, it even worked in an efficient way, and coded in a maintainable manner.</p>

<p>Mixing WebForms and Monorail, CodeSmith based BLL with ActiveRecord/NH, ASP.NET WebServices (asmx) and POX/JSON services, it was a very fun thing to work on, in addition to the business benefit to the company.</p>

<p>However, a few months ago the Web Project Department was closed, and the company started a new R&amp;D team, leadedby Elad, the company’s VP of Business Development. We were two developers (Moran and I), and we worked on several initiatives that the CEO Tamir, and Elad, were cooking all the time. Those projects wereall Community-Driven-So-Called-Web-2.0-Kinda-Websites. It was a real delight, and I got the chance to learn a lot about the business side of running an Internet related initiative, as both Tamir and Elad are experienced and intelligent, and the process of refining ideas, with those two, was a real treat.</p>

<p>They also gave me the freedom to make all the technology decisions, and they’ve had enough faith in me to allow me run the projects using MonoRail and AspView, and running Castle ActiveRecord for DB access. Actually, most of the drive behind creating AspView was actually driven by Elad and Tamir, as I’ve promised to do the best I can to make sure that future additions to the team won’t need to learn Boo / Velocity in addition to learn the Monorail MVC and hql. </p>

<p>Which actually worked great. Moran has left the team about two months ago, and we’ve brought three new guys along (Ili, Ofir and last but not least, Itay), and they have seam to easily get control of all the “funky” technologies I’ve put in use in our projects.</p>

<p>Sadly enough, one of the initiatives has stalled just before airing, due to some business decisions. Then we started a new one, and in about 3 weeks we’ve had a working proof-of-concept, and I really hope that the site will air during August. I give the credit to the team, and to the use of MonoRail/ActiveRecord, as it’s such agile and suits highly-changing-environment, as most web initiatives are.</p>

<p>A point of interest: This very blog’s engine was actually a beta testing for some of the stuff we were using on our last project.</p>

<p>That’s it folks. I wish the SQLink family all the best, and I’m going to keep an eye on the cool stuff the R&amp;D team is doing, and hopefully I’ll report on their success (which would be an AspView success too …) right here on my blog.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/06/24/regionerate-c-region-maker">Regionerate - c# region maker</a></h2>
    <div class="meta">
        <time>on June 24, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/tools" rel="tag">tools</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/activerecord" rel="tag">activerecord</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            
            
        </span>
        
    </div>
    
     <p>Check out <a href="http://regionerate.net/">this nice tool</a> from <a href="http://blog.rauchy.net/">Omer Rauchwerger</a>.</p>

<p>It could help a team to manage a coding convention. Should be very useful in Open Source environments. For example, when committing changes to castle project (or sending a patch) there is a <a href="http://www.castleproject.org/community/codingstandards.html">coding standard</a> than needs to be followed. Regionerate could help a lot with that effort.</p>

<p>I need to see if it can select methods and properties by attributes. It could then help making MonoRail controllers and ActiveRecord decorated classes more readable (region of all actions with a “SkipFilterAttribute”, region of “Property” and region of “HasMany”, etc.)</p>

<p>UPDATE:</p>

<p>Silly me, I forgot to mention that <a href="http://weblogs.asp.net/rosherove/archive/2007/06/24/regionerate-free-code-layout-addin-for-vs-net.aspx">I found about this great tool at Roy Osherov’s blog</a>. A very good one, that is. Many <a href="http://weblogs.asp.net/rosherove/archive/tags/Agile/default.aspx">Agile related stuff</a>, and <a href="http://weblogs.asp.net/rosherove/archive/2007/06/21/que-sera-sera-a-song-about-agile-development.aspx">funny little things</a>, too. <a href="http://feeds.feedburner.com/Iserializable">So go on and subscribe to it’s feed</a>.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/06/16/the-daily-quote-quotthe-single-best-thing-any-aspnet-developer-can-learn-right-now-is-monorailquot">The daily quote: &quot;the single best thing any ASP.NET developer can learn right now is MonoRail&quot;</a></h2>
    <div class="meta">
        <time>on June 16, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>taken from <a href="http://codebetter.com/blogs/karlseguin">Karl Seguin</a> post about his <a href="http://codebetter.com/blogs/karlseguin/archive/2007/06/15/my-net-wishlist.aspx">.net wishlist</a>:</p>

<p>Thinking beyond the common request to implement an MVC pattern, I’d be great if the ASP.NET team could rethink the current model and life cycle. It leaks badly in any complicated scenario. 6 years after its release, I still don’t fully understand it, and I’m ready to bet that I’m in the overwhelming majority. The only time it doesn’t leak is when you don’t need any of the fancy stuff it tries to do. I’m almost at the point where I just don’t use .NET if I’m building a heavy web-based application. Forget learning an O/R mapper, test driven development or understanding domain driven development, the single best thing any ASP.NET developer can learn right now is MonoRail.</p>

<p>Could not agree more …</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/06/15/aspview-a-little-bugfix">AspView - a little bugfix</a></h2>
    <div class="meta">
        <time>on June 15, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/tools" rel="tag">tools</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>If you are an AspView user you might have noticed a problem.</p>

<p>If you setup a nullable-value-type parameter with a default value other than null, then you’d get a casting error.</p>

<p>example:</p>

<p><code>
&lt;%
 int? someInt = default(int);%&gt;
</code></p>

<p><code>
some markup 
</code></p>

<p><code>
&lt;% if (someInt == default(int)) DoSomething();%&gt;
</code></p>

<p>it happened because of the way GetParameter worked </p>

<p>GetParameter is a method that gets a view parameter value from the view’s properties collection (PropertyBag, Flash, Request.Params, etc.). It’s located inthe AspViewBase class (the base class for each and every view in the AspView world).</p>

<p>So, now it’s fixed, and a test was added to make sure it’ll stay that way.</p>

<p>As soon as google.com will be accesible again, you’d be able to check out and build.</p>

<p>UPDATE:</p>

<p>I’m too tired (3am here). The sources are on castle contrib and not on google, so you’d find them <a href="http://svn.castleproject.org:8080/svn/castlecontrib/viewengines/aspview/trunk/">here</a></p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/05/31/castle-build-from-the-trunk-revision-3812">Castle build from the trunk - revision 3812</a></h2>
    <div class="meta">
        <time>on May 31, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/activerecord" rel="tag">activerecord</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            
            
        </span>
        
    </div>
    
     <p>From Castle Project users group:</p>

<p>I’ve just built the trunk yesterday (rev 3812). </p>

<p>Main reason: I needed the BaseControllerTest from Castle.MonoRail.TestSupport.</p>

<p>The build was targeting .NET 2.0, in release, and no tests were run.</p>

<p>You can download it from: <a href="http://kenegozi.com/Castle_r3812_net-2.0_release_not_tested.zip">http://kenegozi.com/Castle_r3812_net-2.0_release_not_tested.zip</a>Note that it is not tested, so use it at your own risk. If you’re not going production this week, it should not be a problem …</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/05/30/nant-085-rc3-and-net-20">NANT 0.85 rc3 and .NET 2.0</a></h2>
    <div class="meta">
        <time>on May 30, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/tools" rel="tag">tools</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            
            
        </span>
        
    </div>
    
     <p>I needed to manually Castle today, for the first time.</p>

<p>The need is for Castle.MonoRail.TestSupport.BaseControllerTest only, so I do not really care about all the rest.</p>

<p>Opened “How to build.txt” </p>

<p>I know that the builds in the CI server are failing due to some filing tests on DP2, so I add “-D:common.run-tests=false”.</p>

<p>no brainer.</p>

<p>I am also targeting .net2 only, so I add “-t:net-2.0”</p>

<p>baboom. This fails.</p>

<p>The nant exe is telling me that I can only build to .net 1.1, or .net compact framework 1.0.</p>

<p>So I went to nant’s config file, and found out to my surprise, that the frameworks that are present there are:</p>

<p>.net 1.1,</p>

<p>.net compact framework 1.0</p>

<p>.net 2.0 BETA 1</p>

<p>hmmm.</p>

<p>So I’ve edited the config, changed the existing .net 2.0 config name to .net2.0Beta1,</p>

<p>copy&amp;pasted the .net node to another one, now switching version number from </p>

<p>sdkdirectory=”${path::combine(sdkInstallRoot, ‘bin’)}” frameworkdirectory=”${path::combine(installRoot, ‘v2.0.40607’)}” frameworkassemblydirectory=”${path::combine(installRoot, ‘v2.0.40607’)}”clrversion=”2.0.40607”</p>

<p>to</p>

<p>sdkdirectory=”${path::combine(sdkInstallRoot, ‘bin’)}” frameworkdirectory=”${path::combine(installRoot, ‘v2.0.50727’)}” frameworkassemblydirectory=”${path::combine(installRoot, ‘v2.0.50727’)}”clrversion=”2.0.50727”  </p>

<p>voila. Now the build is starting.<br />
However, the Castle.Components.Validator.Tests dll refuse to build. I’ll disable it, too.</p>

<p>UPDATE:</p>

<p>I’m an idiot. Did not notice that NAnt has gone far beyond rc3 a long time ago …</p>


    </section>


  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/05/29/syncmarketwatchcom-another-monorail-powered-site">sync.marketwatch.com - Another MonoRail powered site</a></h2>
    <div class="meta">
        <time>on May 29, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            
            
        </span>
        
    </div>
    
     <p>They just keep on coming …</p>

<p><a href="http://sync.marketwatch.com">http://sync.marketwatch.com</a></p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/05/27/new-feature-to-the-blog-a-blogroll">New feature to the blog - a blogroll</a></h2>
    <div class="meta">
        <time>on May 27, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/tools" rel="tag">tools</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            ,&nbsp;
            
            <a href="/blog/tag/personal" rel="tag">personal</a>
            ,&nbsp;
            
            <a href="/blog/tag/blog-engine" rel="tag">blog-engine</a>
            
            
        </span>
        
    </div>
    
     <p>just added a blogroll.</p>

<p>To the DB, to the Domain, to the controller and to the view.</p>

<p>Took me (all in all) 30 minutes, including all the coding, CSS-ing, uploading to the webserver, setting up the DB table on the hosted server, adding a few entries, clearing the browser’s cache, and viewing it.</p>

<p>ah, and committing changes to Google code.</p>

<p>All of that was made in the Budapest Airport cafeteria, while waiting for my flight home (was a great trip. Photos, though not many of them, will be posted later on).</p>

<p>Rest assure that the DB access code is tested, and that the calls to the DB and to the cached data from the Controller and View are all typed.</p>

<p>I’d like to thank NHibernate, Castle and AspView (hey - that’s me !), who made this possible.</p>

<p>I bet Ayende would have done it in 20 …</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/05/21/real-world-aspview-powered-sites">Real world AspView powered sites</a></h2>
    <div class="meta">
        <time>on May 21, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>I’ve just noticed two sites that uses AspView vienegine (of course they’re on MonoRail)</p>

<p>The first, <a href="https://www.musicglue.com/">https://www.musicglue.com/</a>, has the static “home-page” stuff being served from a standard webforms aspx files. The Signup Procees however, and other applicative parts are using MonoRail, with AspView based views. The team behind this site said to me that they’re moving to a complete MonoRail/AspView solution in time.</p>

<p>The other, <a href="http://www.escapegreat.com/">http://www.escapegreat.com/</a>, is using AspView, top to bottom.</p>

<p>Both sites seam to be working great. </p>

<p>Gives me strength to continue the development on AspView, and find ways to improve it even better.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/05/20/a-new-version-of-aspview-07">A new version of AspView - 0.7</a></h2>
    <div class="meta">
        <time>on May 20, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/asp-net-2-0" rel="tag">asp-net-2-0</a>
            ,&nbsp;
            
            <a href="/blog/tag/tools" rel="tag">tools</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>I’ve just commited to the repository a new version of AspView.</p>

<p>The main addition is “Auto Recompilation” feature.</p>

<p>This means that when you change one of the view sources, the application will automatically recompile the views upon the following request.</p>

<p>You enable the feature by adding the next attribure to the aspview config section in web.config:</p>

<p><code>
&lt;aspview .... autoRecompilation="true" ... &gt; ...&lt;/aspview&gt;
</code></p>

<p>Breaking change:</p>

<p>If you happen to reference an assembly from the GAC (using the aspview configuration in the web.config) you need to add a hint for the engine, like this:</p>

<p><code>
&lt;reference assembly="MyAssemblyFromGAC.dll" isFromGac="true" /&gt;
</code></p>

<p>Known issues:</p>

<ol>
  <li>
    <p>You need to let ASPNET user (or the Application Pool user) a modify access on the bin folder.Note that if you use the inner WebServer of Visual Studio this should not be a problem, since in that case the web application runs with your user, that has the needed peremissions on the bin folder.</p>
  </li>
  <li>
    <p>For a strange reason, after you change a view and do the F5 in the browser, you still see the old version, and only on second F5 will the views be actually recompiled and refreshed. I hope to fix it soon …</p>
  </li>
</ol>

<p>Download from <a href="http://kenegozi.com/blog/uploaded/AspView_0_7_178.zip">here</a>.</p>

<p>Sources are <a href="http://svn.castleproject.org:8080/svn/castlecontrib/viewengines/aspview/trunk/">here</a>.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/05/08/rubynet-integration-in-visual-studio-plus-debugging-support">Ruby.NET integration in Visual Studio, plus debugging support</a></h2>
    <div class="meta">
        <time>on May 8, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/visual-studio" rel="tag">visual-studio</a>
            ,&nbsp;
            
            <a href="/blog/tag/visual-studio-2005" rel="tag">visual-studio-2005</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            
            
        </span>
        
    </div>
    
     <p>I’ve just got the announcement from the Ruby.NET team at QUT, about the new beta release, numbered 0.7.</p>

<p>The two major things in there:</p>

<ol>
  <li>
    <p>the compiler now creates pdb files, which means that it can be debugged with the interactive debuggers, </p>
  </li>
  <li>
    <p>Visual Studio 2005 integration, including Ruby projects.</p>
  </li>
</ol>

<p>Can’t wait to check this out.</p>

<p>I’d like to see if I can do some integration into the AspView project, to enable a RubyOnMonoRail thing. I guess it’d have to wait for the BCL integration, promised to be released around the end of this year, but it is quite interesting as it is right now.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/03/19/activewriter-2nd-preview-is-out">ActiveWriter - 2nd preview is out</a></h2>
    <div class="meta">
        <time>on March 19, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/visual-studio" rel="tag">visual-studio</a>
            ,&nbsp;
            
            <a href="/blog/tag/visual-studio-2005" rel="tag">visual-studio-2005</a>
            ,&nbsp;
            
            <a href="/blog/tag/tools" rel="tag">tools</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/activerecord" rel="tag">activerecord</a>
            ,&nbsp;
            
            <a href="/blog/tag/nhibernate" rel="tag">nhibernate</a>
            
            
        </span>
        
    </div>
    
     <p>ActiveWriter is a VS2005 plugin, that adds a new item type for your projects. This item is actually a visual designer for ActiveRecord classes. Quite neat, and hopefully will increase the penetration of Castle’s ActiveRecord to the “If there’s no VS wizard, I do not use it” kinda guys.</p>

<p>You can read about it and download it from <a href="http://altinoren.com/activewriter/">http://altinoren.com/activewriter/</a></p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/03/17/monorail-is-gaining-interest">MonoRail is gaining interest</a></h2>
    <div class="meta">
        <time>on March 17, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/asp-net-2-0" rel="tag">asp-net-2-0</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            
            
        </span>
        
    </div>
    
     <p>I’d like to point you to a <a href="http://www.hanselminutes.com/default.aspx?showID=71">new podcast from HanselMinutes, about MonoRail</a>. Scott Hanselman is interviewing a couple of guys from Eluetian as MonoRail Power Users. Theyare doing a lot of workwith MonoRail using Brail. </p>

<p>Listen to that if you want to hear about how simple MVC for ASP.NET can be.</p>

<p>Actually, It seams that it is getting so much attention, that even MSFT are thinking about implementing something Rails-i in the future ASP.NET. <a href="http://codebetter.com/blogs/jeffrey.palermo/archive/2007/03/16/Big-News-_2D00_-MVC-framework-for-ASP.NET-in-the-works-_2D00_-level-300.aspx">Read this if you do not believe me</a>.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/02/17/aspview-06-is-out">AspView 0.6 is out</a></h2>
    <div class="meta">
        <time>on February 17, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>What’s new?</p>

<ol>
  <li>
    <p>Support for ViewComponents, including those with Sections. It is tested against CaptureFor, and GridComponent.</p>
  </li>
  <li>
    <p>You can now specify saveFiles=”true” in the config, and the compiler will leave the .cs files generated from the views to the disk, so you can match compilation errors from Visual Studio directly to the view’s concrete class source.</p>
  </li>
</ol>

<p>The syntax for the ViewComponents is xml-like: just add</p>

<p>```</p>
<component:viewcomponentnamearguments><section:sectionname></section:sectionname>Some content  
```

where VIEWCOMPONENTNAME is the component's class name, SECTIONNAME is the section name, for components that uses sections, and the ARGUMENTS are xml-attributes, for example: id="capturedContent" myData="&lt;%=items %&gt;"

examples (from the test site):

for constant arguments:

```
&lt;component:CaptureForid="capturedContent"&gt;   This content should be rendered in the captured-for place holder  
```

for variable arguments:

```
&lt;component:GridComponentsource="&lt;%=items%&gt;"&gt;    <section:header><table><thead><th>Id</th><th>Word</th></thead><section:item><tr><td>1</td><td>&lt;%=item %&gt; </td></tr></section:item><section:footer></section:footer>
```

As usual, source code is at [http://svn.castleproject.org:8080/svn/castlecontrib/viewengines/aspview/trunk/](http://svn.castleproject.org:8080/svn/castlecontrib/viewengines/aspview/trunk/), 

Note that for a successful build you'd need to fix the siteRoot parameter in vcompils's app.config, to point to the actual physical path to the test site's root



</table></section:header></component:viewcomponentnamearguments>

    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/02/14/long-time-no-posting-must-write">Long time no posting. Must write.</a></h2>
    <div class="meta">
        <time>on February 14, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/activerecord" rel="tag">activerecord</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            ,&nbsp;
            
            <a href="/blog/tag/personal" rel="tag">personal</a>
            
            
        </span>
        
    </div>
    
     <p>I haven’t written much lately, since I was:</p>

<p>a. Learning for my final exam so I’d get my Bachelor’s Degree at this decade.b. Under a lot of preassure at work, since we have a cool web2.0 thingie approaching a public beta real soon (will be followed).c.Sneasing my heart out, darn flew.d.Got into a new project at my personal business. This one is driven by Castle’s ActiveRecord+MonoRail+AspView, and due to the client’s request it’ll use Access as the backend DB, and that would be a first-time-ActiveRecord/access for me. I still hope to convince him to at-least go for embedded FireBird.</p>

<p>So, stay tuned to some experiences with AspView, and hopefully in about a month you’ll havetwo MonoRail/AspView driven websites out in the open. I am excited. Are you?</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/01/08/introducing-viewfilters">Introducing ViewFilters</a></h2>
    <div class="meta">
        <time>on January 8, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>Here is the latest addition to AspView.</p>

<p>example: </p>

<p><code>
&lt;%@PageLanguage="C#"Inherits="Castle.MonoRail.Views.AspView.ViewAtDesignTime"%&gt;  &lt;%  %&gt;  Outside the filter  &lt;filter:LowerCase&gt;Inside the LowerCaseViewFilter - this text should be viewed in lower case&lt;/filter:LowerCase&gt;  Outside the filter AGain  &lt;filter:UpperCase&gt;  Inside the UpperCaseViewFilter - this text should be viewed in upper case  &lt;/filter:UpperCase&gt;  Finally - outside the filter
</code></p>

<p>As you can see, the syntax is simple. Given a viewFilter, named “MyViewFilter”, you use the xml tag <filter:my> or <filter:myviewfilter>. The viewfilter itself has to be suffixed with "ViewFilter" (Just like Controllers are suffixed with "Controller", etc.), and it has to implement IViewFilter which is defined with:</filter:myviewfilter></filter:my></p>

<p><code>
using System;using System.Collections.Generic;  using System.Text;    namespace Castle.MonoRail.Views.AspView  {publicinterfaceIViewFilter     {string ApplyOn(string input);         }}  
</code></p>

<p>The power of the ViewFilters is than they can apply to a whole SubView, while the subview is rendered as a black box, the filter does the work AFTER the subview was rendered.</p>

<p>Grab the <a href="http://svn.castleproject.org:8080/svn/castlecontrib/viewengines/aspview/trunk/">sources</a>, play, and have fun.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/01/05/aspview-has-entered-castlecontrib">AspView has entered CastleContrib</a></h2>
    <div class="meta">
        <time>on January 5, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>After hammet’s approval, I hav finallyadded AspView source to the Castle Project’s Contrib section of the subversion repository.</p>

<p>Thank hammet and the rest of the Castle crew for voting for that.</p>

<p>So from now on, you’d be able to grab the sources from <a href="http://svn.castleproject.org:8080/svn/castlecontrib/viewengines/aspview/">http://svn.castleproject.org:8080/svn/castlecontrib/viewengines/aspview/</a></p>

<p>Two last comments:1.The latest edition works with Castle’s trunk from build 229.2. The latest additions are supporting “~” as a macro for siteRoot, and “~~” as a fullSiteRoot (~ would expand to the virtual directory, and ~~ would expand to full url- http://…).</p>


    </section>


  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2007/01/04/nhibernate-could-not-find-constructor-for-in-select-new-projection-query">NHibernate ' Could not find constructor for: ' in ' select new ' projection query</a></h2>
    <div class="meta">
        <time>on January 4, 2007</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/activerecord" rel="tag">activerecord</a>
            ,&nbsp;
            
            <a href="/blog/tag/nhibernate" rel="tag">nhibernate</a>
            ,&nbsp;
            
            <a href="/blog/tag/hql" rel="tag">hql</a>
            
            
        </span>
        
    </div>
    
     <p>There are two facts here:1. I love NHibernate.2. I hate NHibernate’s exception messages.</p>

<p>And here’s my story.</p>

<p>On a project I’m working on, I need to show a projection of “top 10” from the database. let’s show this on the good old Blog scenario:<img src="http://kenegozi.com/blog/uploaded/WindowsLiveWriter/NHibernateCouldnotfindconstructorforinse_A7E6/Post-Comment-Stupid_erd_thumb%5B2%5D.gif" alt="" /></p>

<p>So I want to show the posts with the longest comments measured by the comment’s length. Stupid, huh? but it’s a demo only (I cannot expose the actual ERD). Let’s say I want the top 5.</p>

<p>I am using Castle ActiveRecord. There is a Post and a Comment classes. However, I do not wish to load Posts objects, since It will load the Comments, too, and maybe other stuff that the Post class is related to. So I have defined a PostProjection class: </p>

<p><code>
   1:  publicclass PostProjection
</code></p>

<p><code>
   2:  {
</code></p>

<p><code>
   3:  publicstring Title;
</code></p>

<p><code>
   4:  publicint Length;
</code></p>

<p><code>
   5:  public PostProjection(string title, int length)
</code></p>

<p><code>
   6:      {
</code></p>

<p><code>
   7:          Title = title;
</code></p>

<p><code>
   8:          Length = length;
</code></p>

<p><code>
   9:      }
</code></p>

<p><code>
  10:  }
</code></p>

<p>I have also added an [Import] attribute on the Post. The actual querying is done using the next hql:</p>

<p><code>
   1:  publicstatic PostProjection[] GetTopPosts(int postsToGet)
</code></p>

<p><code>
   2:  {
</code></p>

<p><code>
   3:      SimpleQuery&lt;PostProjection&gt; q =
</code></p>

<p><code>
   4:  new SimpleQuery&lt;PostProjection&gt;(typeof(Post), @"
</code></p>

<p><code>
   5:          select new PostProjection(p.Title, sum(c.LineCount)) 
</code></p>

<p><code>
   6:          from 
</code></p>

<p><code>
   7:              Post p inner join 
</code></p>

<p><code>
   8:              p.Comments c 
</code></p>

<p><code>
   9:          order by sum(o.LineCount) desc
</code></p>

<p><code>
  10:          group by p.Title");
</code></p>

<p><code>
  11:      q.SetQueryRange(postsToGet);
</code></p>

<p><code>
  12:  return q.Execute();
</code></p>

<p><code>
  13:  }
</code></p>

<p>It worked great.</p>

<p>Yesterday I’ve upgraded my Castle dll’s to the ones from build 229. It includes NHibernate 1.2.0.2002</p>

<p>Now the “select new” started to fail, and NHibernate started to claim than “Could not find constructor for: PostProjection”.</p>

<p>I’ve been scratching my head, trying various approaches, and even was keen to skip the “new” and use an object[ ] and populate the Projection Array by hand, but then I tried changing the “length” parameter of the constructor from “int” to “long”. Magically it solved the problem.</p>

<p>Now, if only NHibernate would have said :</p>

<p>Could not find constructor for: PostProjection.Looking for: PostProjection(string, long)</p>

<p>I would’ve known what the problem was, and what should I change.</p>

<p>So what have we learned today?</p>

<ol>
  <li>NHibernate expects sum() to return “long” rather than “int”2. NHibernate’s error messages suck.</li>
</ol>

<p>I’ve svn-ed the NHibernate trunk, added some code so this message would be more developer friendly, and I’m going to send the patch to NHibernate’s JIRA.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2006/12/10/some-improvements-in-aspview-revision-47-is-out">Some improvements in AspView - revision 47 is out</a></h2>
    <div class="meta">
        <time>on December 10, 2006</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/asp-net-2-0" rel="tag">asp-net-2-0</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>What’s new?</p>

<ol>
  <li>
    <p>siteRoot has been added to AspViewBase, so you can ditch the “string siteRoot” from the declerations area.</p>
  </li>
  <li>
    <p>Some permormance improvements. Instead of using “Activator.CreateInstance” everytime a view is to be rendered, a hashtable with ConstructorInfo objects is generated upon reading CompiledViews.dll. This was taken from the c# version of Brail</p>
  </li>
  <li>
    <p>A new syntax for subviews:</p>
  </li>
</ol>

<p>you can use </p>

<p><code>
   1:  &lt;subView:MyMenu item="menuItem"&gt;&lt;/subView:MyMenu&gt;
</code></p>

<p>instead of </p>

<p><code>
   1:  &lt;% OutputSubView("MyMenu", Helper.Dict("item", "menuItem")); %&gt;
</code></p>

<p>take note the <subview:blah></subview:blah> is not currently allowed. I’ll fix it shortly.</p>

<p>the link is <a href="http://kenegozi.com/blog/GetFile.ashx?FileName=AspView_rev47.zip">here</a></p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2006/12/03/things-ive-been-doing-lately">Things I've been doing lately</a></h2>
    <div class="meta">
        <time>on December 3, 2006</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/asp-net-2-0" rel="tag">asp-net-2-0</a>
            ,&nbsp;
            
            <a href="/blog/tag/client-side" rel="tag">client-side</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/activerecord" rel="tag">activerecord</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>I’ve been off the radar lately, due to some extensive work I do on a website for my employer.</p>

<p>It is still in early stages and I cannot talk about the site itself, but I can talk a little about the technology that drives it.</p>

<p>In one word: Castle.</p>

<p>In a few more words: </p>

<p>Data Access and OR/m: Castle’s ActiveRecord over NHibernate</p>

<p>Web UI Engine: Castle’s MonoRail</p>

<p>ViewEngine: <a href="http://kenegozi.com/blog/2006/11/27/AspViewRev38IsOut.aspx">AspView</a> (by yours truely, inspired by Ayende’s <a href="http://www.ayende.com/projects/brail.aspx">Brail</a>). All my spare time from work goes there.</p>

<p>Client Side Javascript stuff: <a href="http://prototype.conio.net/">Prototype</a> and <a href="http://script.aculo.us/">Scriptaculous</a>.</p>

<p>I really believe in the efforts made by Castle group, and I hope the the site I’m working on will be successful, as to serve for yet another prove of concept.</p>

<p>One more thing I’m doing last month, is that I’ve decided to finally end the thing with my Bachelor’s degree. I needed to retake Linear Algebra I (yep, that one the all the non-bullet-time Matrixes … I H-A-T-E adjoined matrixes. yuck) so that’s actually why AspView doesn’t progress as I’d want it too (and as some of my readers want, too).</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2006/11/27/aspview-rev-38-is-out">AspView rev 38 is out</a></h2>
    <div class="meta">
        <time>on November 27, 2006</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/asp-net-2-0" rel="tag">asp-net-2-0</a>
            ,&nbsp;
            
            <a href="/blog/tag/visual-studio" rel="tag">visual-studio</a>
            ,&nbsp;
            
            <a href="/blog/tag/visual-studio-2005" rel="tag">visual-studio-2005</a>
            ,&nbsp;
            
            <a href="/blog/tag/c-sharp" rel="tag">c-sharp</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>What we have:</p>

<ol>
  <li>
    <p>Default Helpers are now declared in the AspViewBase. It means that you can use &lt;%=FormHelper.LabelFor(…) %&gt; without the need to declare the helper at the begining of the view.</p>
  </li>
  <li>
    <p>the compiler was refactored to allow for better testing, and for implementation of further view languages. vurrently I’ve started with VB.NET but it is not working yet, since I have no time to make sure the VB syntax is correct. The tests of the compiler are missing due to some stupidity on my side, of not commiting the TestCase …</p>
  </li>
</ol>

<p>I’ve wanted to let svn access but I have some trouble with that. I’ve started a sourceforge project but I cannot upload the repo to the site. I did all they’ve asked on the site but the import process reporting failure no matter what I do. I guess that the best way will be if the Castle team would allow AspView into it’s codebase, maybe on the Contrib repo to begin with …</p>

<p>So meanwhile you can download the current bits from <a href="http://kenegozi.com/blog/GetFile.ashx?FileName=AspView_rev38.zip">here</a>.</p>

<p>Keep me posted,</p>

<p>Ken.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2006/11/26/hammet-likes-aspview">Hammet likes AspView</a></h2>
    <div class="meta">
        <time>on November 26, 2006</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>Just <a href="http://hammett.castleproject.org/?p=88">read it</a>.</p>

<p>I started commenting to that post, but I figured that the people who’ve downloaded AspView up to now (I have about 30 or so downloads last week) will want to read it, so I’m posting it here.</p>

<p>So, as Hammet said, the extension is determined on the web.config. The .aspx is used for the view source files so VSNET will color and intellisense them. however, the actions are mapped to an extension that is mapped in the web.config.Still, AspView have some .aspx hard-coded in it, simply cuz I needed to get something working, and working fast. This is why I’ve left non-crucial features out for the moment, such as:1. Dynamic compilation (It is non crucial. IMHO real applications should be pre-compiled, while the dynamic thingie is for design time only)2. Nicer code (more maintainable, less typos such as “extention”, refactoring for testability).3. View Components (subviews are doing the trick for me for now, but in order to mature there must be implementation for it) 4. using the .config. 5. A lot more</p>

<p>btw, helpers ARE supported, You just need to add the declaration in the place, like </p>

<p>&lt;% Post[] posts;AjaxHelper AjaxHelper;AjaxHelper AjaxHelper;%&gt;</p>

<p>In the trunk there is some improvements, such as refactored AspViewCompiler, so it uses a PreProcessor that has subtypes. Currently it has a working CSharpPreProcessor, and a non-working VbPreProcessor. I intend to try adding a BrailPreProcessor … I hope to be able to mix view languages in the same site. each language group will be compiled to a module, and linked to the CompiledViews.dll assembly. </p>

<p>Since I haven’t set any public repository yet, and since I do not have much time for uploading bits manually, you cannot see the work in progress, and it’s my bad. I’ll upload the latest stuff soon, and I’m working on setting up a repo somewhere. btw - do you have recommendation? (CodePlex? Sf? ) </p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2006/11/16/aspview-first-release">AspView - first release</a></h2>
    <div class="meta">
        <time>on November 16, 2006</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/asp-net-2-0" rel="tag">asp-net-2-0</a>
            ,&nbsp;
            
            <a href="/blog/tag/visual-studio" rel="tag">visual-studio</a>
            ,&nbsp;
            
            <a href="/blog/tag/visual-studio-2005" rel="tag">visual-studio-2005</a>
            ,&nbsp;
            
            <a href="/blog/tag/c-sharp" rel="tag">c-sharp</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>So I’m releasing <a href="http://kenegozi.com/blog/2006/11/14/AspViewYetAnotherMonoRailViewEngine.aspx">AspView</a>.</p>

<p>You can download the source from <a href="http://kenegozi.com/blog/GetFile.ashx?FileName=AspView_rev20.zip">here</a>.</p>

<p>It was written against the Castle 1.1 from the trunk, build no. 152.</p>

<p>Please note that in order to run the TestCases you’d have to make sure that the latest Castle.MonoRail.TestSupport is in the GAC.</p>

<p>The documentation is poor since I have a little time now. I am working on a website for my employer (that utilizes AspView and AR) and until the first beta release I won’t have time to do anything but major bugfixes. This project isn’t open sourced so I won’t be able to share it’s sources, however since this will be a public site, it would serve as a Proof Of Concept to the MonoRail and AspView.</p>

<p>The views MUST have the following structure: a. Page header - Must be present for intellisense to work:</p>

<p><code>
   1:  &lt;%@ Page Language="C#" Inherits="Castle.MonoRail.Views.AspView.ViewAtDesignTime"%&gt;
</code></p>

<p>b. Directives - Not mandatory:</p>

<p><code>
   1:  &lt;%@ Import Namespace="System.Text"%&gt;   2:  &lt;%@ Import Namespace="System.Drawing"%&gt;
</code></p>

<p>c. Properties decleration - Currently it’s mandatory. If you have no properties you mast have an empty block:</p>

<p><code>
   1:  &lt;%   2:  string[] strings;   3:      DateTime today;   4:  int index;   5:  %&gt;
</code></p>

<p>or just</p>

<p><code>
   1:  &lt;%   2:  %&gt;
</code></p>

<p>d. View body</p>

<p>In a layout view you place the inner view using the ViewContents property, like this:</p>

<p><code>
   1:  blah   2:  blah   3:  &lt;%=ViewContents%&gt;   4:  blah   5:  blah
</code></p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2006/11/14/aspview-yet-another-monorail-viewengine">AspView - Yet another MonoRail ViewEngine</a></h2>
    <div class="meta">
        <time>on November 14, 2006</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/asp-net-2-0" rel="tag">asp-net-2-0</a>
            ,&nbsp;
            
            <a href="/blog/tag/visual-studio" rel="tag">visual-studio</a>
            ,&nbsp;
            
            <a href="/blog/tag/visual-studio-2005" rel="tag">visual-studio-2005</a>
            ,&nbsp;
            
            <a href="/blog/tag/c-sharp" rel="tag">c-sharp</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            ,&nbsp;
            
            <a href="/blog/tag/aspview" rel="tag">aspview</a>
            
            
        </span>
        
    </div>
    
     <p>.hlt { background-color:yellow;}<br />
So what is AspView?</p>

<p>It is a Visual Studio 2005 friendly ViewEngine implementation.</p>

<p>The scripting is done using VisualStudio languages (c# and VB.NET). The views are precompiled, (or can be compiled on-demand, but anyway not interpreted).</p>

<p>The project was inspired by the <a href="http://www.castleproject.org/monorail/documentation/trunk/viewengines/brail/index.html">Brail ViewEngine</a>, but since it doesn’t use <a href="http://boo.codehaus.org/">Boo</a> it is more Management-Friendly, since they need not worry about getting out of the “safe” microsoft world.</p>

<p>I tend to like Boo as a language very much, and <a href="http://kenegozi.com/blog/2006/09/20/MyPresentationLayerOfChoiceBrailOverCastlesMonoRail.aspx">I like Brail</a> a lot, too (since it allows for less code in the view thanks to the Boo magic) but I lack the tight Visual Studio integration (opening .boo files in #Develop messes up my desktop), and the intellisense is quite important, at least for the developers I worl with.</p>

<p>So I will post in the next few days about it, and I’ll make it available to be downloaded (source and binary) as soon as I’ll test it a little more. I hope to have a public svn repository soon.</p>

<p>A little demo view:</p>

<p><code>
   1:  &lt;%@ Page Language="C#" Inherits="Castle.MonoRail.Views.AspView.ViewAtDesignTime"%&gt;   2:  &lt;%   3:  string[] strings;   4:  %&gt;   5:     6:     7:  hello from index&lt;br /&gt;   8:  This are the strings:&lt;br /&gt;   9:  &lt;%foreach (string s in strings) { %&gt;  10:  &lt;%=s %&gt;&lt;br /&gt;  11:  &lt;%  } %&gt;  12:    13:  &lt;br /&gt;  14:  End of normal view  15:  &lt;br /&gt;  16:  &lt;% OutputSubView("Home/SubViewSample"); %&gt;
</code></p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2006/11/05/building-application-using-castle-rc2">Building Application using Castle RC2</a></h2>
    <div class="meta">
        <time>on November 5, 2006</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/asp-net-2-0" rel="tag">asp-net-2-0</a>
            ,&nbsp;
            
            <a href="/blog/tag/architecture" rel="tag">architecture</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/activerecord" rel="tag">activerecord</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            
            
        </span>
        
    </div>
    
     <p>Ayende has recently posted a walkthrough for building Web Apps using the Castle Project’s libraries.</p>

<p>He covers ActiveRecord and MonoRail basics, showing off some of the shiny and new abilities (AR scaffolding, ARSmartDispatchers, Generics integration and so on).</p>

<p>The only thing missing is IoC-ing using Winsdor or even Binsdor. Maybe to hook some BL layer or something.</p>

<p>So it concludes (as of now) a <a href="http://www.ayende.com/Blog/BuildingApplicationsUsingCastleRC2PartI.aspx">Part I</a>, <a href="http://www.ayende.com/Blog/BuildingApplicationsUsingCastleRC2PartII.aspx">Part II</a> , and <a href="http://www.ayende.com/Blog/DemoCodeForCastleForumsDemoApp.aspx">source-code</a>.</p>

<p>If you wanna see a decent web development framework at action - tune up to those posts.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2006/10/26/monorail-vs-webforms">MonoRail vs. WebForms</a></h2>
    <div class="meta">
        <time>on October 26, 2006</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/asp-net-2-0" rel="tag">asp-net-2-0</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/activerecord" rel="tag">activerecord</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            
            
        </span>
        
    </div>
    
     <p>Ayende <a href="http://www.ayende.com/Blog/MonoRailVsASPNet.aspx">has posted about the matter</a>, only he’ve used the title “MonoRail vs. ASP.NET” instead. I think that his title isn’t accurate since MonoRail is actually a WebForms replacement that is built ontop of ASP.NET, exploiting all of the cool features found in ASP.NET and in the .NET framework alltogether. It’s the Web development framework that Microsoft forgot. So it has the benefits of the Rails interpretaion for MVC, with the power of .NET.</p>

<p>Here is the comment I’ve posted to Ayende’s post:</p>

<p>“My point of argue in favor of MR for people who are afraid of “non-microsoft” is, that actually MR is ASP.NET. It is just not WebForms. You get all the good stuff from ASP.NET: the .NET framework for start, compiled views (on Brail - kudos to you), the HttpModule stuff, seeamless integration with AR. This is what I say to the PMs, etc. To the developers themselves who are afraid, There’s a more detailed approach. Developers (especially ones who didn’t do web programming aside ASP.NET, and probably has a lot of VB experience but no PHP/JSP/ASP) like WebForms cuz they can get to the txtUsername.Text, txtPassword.Text, and txtAge.Text easily, not needing Request.Form[“Password”] (hey - it’s not typed !!!) . But then I reffer them to the fact that actually txtAge.Text isn’t typed too. it’s a string, and should be parsed, tried, validated etc. They should also manually create a User instance, and fill it’s properties. Doing the same on MR with Dispatching and AR is there without any line of code. I show them an example aqnd then hold them as they almost fall off their chairs. Not’n like a good example. Maybe having a ViewEngine that’s use c# or VB.NET instead of boo (not the WebForm ViewEngine which suck, but somthing similar to Brail) can make the move from WebForms to easier for developers, but frankly, as you’ve said, people who can’t get it OJT with a few examples aren’t the one’s I’m likely to work with anyway.”</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2006/10/21/aspnet-ajax-aka-atlas-is-maturing-and-reached-beta-1-stage">ASP.NET Ajax (aka ATLAS) is maturing and reached Beta 1 stage</a></h2>
    <div class="meta">
        <time>on October 21, 2006</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/asp-net-2-0" rel="tag">asp-net-2-0</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            
            
        </span>
        
    </div>
    
     <p>As said in the title, ASP.NET Ajax (aka ATLAS) is maturing and reached Beta 1 stage.</p>

<p>I haven’t being too mush into it lately, since I’ve beenunder the impression that though Microsoft’s ASP.NET Ajax library was very rich and had many features, it also suffered from many childhood problems, including too many js errors, and a huge .js script to download.</p>

<p>Now, it has an official name, and a beta release, and it’s maturing. The .js was split by functionality, release and debug version of the .js are present, prototyped classes have replaced the closure based ones, and it’s better for me cuz I find it easier to <em>overload</em> behaviuors when needed.</p>

<p>So <a href="http://ajax.asp.net/default.aspx?tabid=47&amp;subtabid=471">try it out</a>and read what <a href="http://weblogs.asp.net/scottgu">Scott Guthrie</a> has to <a href="http://weblogs.asp.net/scottgu/archive/2006/10/20/ASP.NET-AJAX-Beta-1-Released.aspx">say about it</a>.</p>

<p>Since nowadays I’m more into <a href="http://www.castleproject.org/index.php/MonoRail">MonoRail</a> over <a href="http://www.ayende.com/projects/brail.aspx">Brail</a> than into Webforms, I guess that the Core package is what really intresting for me, and I’ll try to combine it with <a href="http://wiki.castleproject.org/monorail/documentation/trunk/helpers/ajax/index.html">AjaxHelper</a> from MonoRail. I hope to report on the matter shotrly.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2006/10/16/on-wheels-and-squares">On Wheels and Squares</a></h2>
    <div class="meta">
        <time>on October 16, 2006</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/miscellanea" rel="tag">miscellanea</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/activerecord" rel="tag">activerecord</a>
            
            
        </span>
        
    </div>
    
     <p>On a small debate with a friend, about weather he should design and implement a Data Access Layer himself, or use an existing framework, I came across a piece by <a href="http://www.ayende.com/Blog">Ayende</a> about <a href="http://www.ayende.com/Blog/25ReasonsNotToWriteYourOwnObjectRelationalMapper.aspx">25 Reasons Not To Write Your Own Object Relational Mapper</a>.</p>

<p>I’d like to add a quote from <a href="http://www.amazon.com/gp/redirect.html?ie=UTF8&amp;location=http%3A%2F%2Fwww.amazon.com%2FCode-Complete-Second-Steve-McConnell%2Fdp%2F0735619670%2Fsr%3D8-1%2Fqid%3D1161008471%3Fie%3DUTF8%26s%3Dbooks&amp;tag=kenegoziswebl-20&amp;linkCode=ur2&amp;camp=1789&amp;creative=9325">Code Complete 2</a><img src="http://www.assoc-amazon.com/e/ir?t=kenegoziswebl-20&amp;l=ur2&amp;o=1" alt="" /> about programmers who are reluctant to read (and use) existing solutions to known problems (on p. 823): </p>

<p>… even if you want to reinvent the wheel, you can’t count on success. You might reinvent the square instead.</p>

<p>It’s definitely not a <a href="http://www.amazon.com/gp/search?ie=UTF8&amp;keywords=Dave%20Barry&amp;tag=kenegoziswebl-20&amp;index=books&amp;linkCode=ur2&amp;camp=1789&amp;creative=9325">Dave Barry</a><img src="http://www.assoc-amazon.com/e/ir?t=kenegoziswebl-20&amp;l=ur2&amp;o=1" alt="" /> kinda funny punch line, however it’s very much to-the-point.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2006/10/10/a-generic-execute-callback-for-activerecord-executelttgt">A Generic Execute Callback for ActiveRecord - Execute&lt;T&gt;</a></h2>
    <div class="meta">
        <time>on October 10, 2006</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/c-sharp" rel="tag">c-sharp</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/activerecord" rel="tag">activerecord</a>
            
            
        </span>
        
    </div>
    
     <p>I am working with AR for a few month now, ignorantly ignoring the <a href="http://wiki.castleproject.org">Castle Project’s wiki</a>.</p>

<p>Stupid I am. I could have learned a lot and save a bunch of wandering around the net and the intellisense to learn obvious stuff.</p>

<p>Thanks to <a href="http://hammett.castleproject.org/">hammett</a> who <a href="http://kenegozi.com/blog/CommentView,guid,BCCBB3BE-CB4B-4859-A675-0C4918C0900D.aspx">pointed me there</a>.</p>

<p>Anyway - now I read it from &lt;html&gt; to &lt;/html&gt;, and I saw the part <a href="http://wiki.castleproject.org/activerecord/documentation/trunk/usersguide/hql.html#ExecCallback">about running HQL using the Execute Callback</a></p>

<p>There are examples, each one with two flavors: “not using generics”, and “using generics”. Well, the one about the Execute Callback is misleading. It should have been “not using anonymous method” and “using anonymous methods”, since the second one does not use generics.</p>

<p>So I thought - let’s make the API simpler.</p>

<p>We would have like to allow the user execute her hql like that:</p>

<p><code>
   1:  publicstatic Post[] GetPostsByAuthorName(string authorName)
</code></p>

<p><code>
   2:  {
</code></p>

<p><code>
   3:  return (Post[])Execute(typeof(Post), "from Post p where p.Author = ?", authorName);
</code></p>

<p><code>
   4:  }
</code></p>

<p>Or even better, by using generics (this time for real):</p>

<p><code>
   1:  publicstatic Post[] GetPostsByAuthorName(string authorName)
</code></p>

<p><code>
   2:  {
</code></p>

<p><code>
   3:  return Execute&lt;Post&gt;("from Post p where p.Author = ?", authorName);
</code></p>

<p><code>
   4:  }
</code></p>

<p>Here is the magic:</p>

<p><code>
   1:  publicstatic T[] Execute&lt;T&gt;(string hql, paramsobject[] parameters)
</code></p>

<p><code>
   2:  {
</code></p>

<p><code>
   3:      IList untypedResults = (IList)Execute(delegate(ISession session, object data)
</code></p>

<p><code>
   4:      {
</code></p>

<p><code>
   5:  object[] queryParams = (object[])data;
</code></p>

<p><code>
   6:          IQuery query = session.CreateQuery(hql);
</code></p>

<p><code>
   7:  for (int position = 0; position &lt; queryParams.Length; ++position)
</code></p>

<p><code>
   8:              query.SetParameter(position, queryParams[position]);
</code></p>

<p><code>
   9:  return query.List();
</code></p>

<p><code>
  10:      }, parameters);
</code></p>

<p><code>
  11:      T[] results = new T[untypedResults.Count];
</code></p>

<p><code>
  12:      untypedResults.CopyTo(results, 0);
</code></p>

<p><code>
  13:  return results;
</code></p>

<p><code>
  14:  }
</code></p>

<p>I’ll add an overload that will accept named parameters. I am not sure about the right way to do that, though.</p>

<p>My options are:</p>

<p><code>
   1:  Execute&lt;T&gt;(string hql, 
</code></p>

<p><code>
   2:  string[] paramNames, 
</code></p>

<p><code>
   3:      Type[] paramTypes, 
</code></p>

<p><code>
   4:  object[] parameters)
</code></p>

<p>Or:</p>

<p><code>
   1:  Execute&lt;T&gt;(string hql, IParameter[] parameters)
</code></p>

<p>where IParameter definition is something like:</p>

<p><code>
   1:  publicinterface IParameter&lt;T&gt;
</code></p>

<p><code>
   2:  where T: Type
</code></p>

<p><code>
   3:  {
</code></p>

<p><code>
   4:  publicstring Name { get; set;}
</code></p>

<p><code>
   5:  public T Value { get; set;}
</code></p>

<p><code>
   6:  }
</code></p>

<p>Maybe both?</p>

<p>And maybe I haven’t read the wiki thoroughly enough and there are already implementations for all that?</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2006/10/08/projection-using-activerecords-importattribute-and-hqls-select-new-clause">Projection using ActiveRecord's ImportAttribute and HQL's select new clause</a></h2>
    <div class="meta">
        <time>on October 8, 2006</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/activerecord" rel="tag">activerecord</a>
            
            
        </span>
        
    </div>
    
     <p>WARNING:I’m going to use some lousy examples in this post. Please bear with me, and stick to the Point rather than to the actual Classes being presented.</p>

<p>What is a projection?</p>

<p>Consider this genius ERD:</p>

<p><img src="http://kenegozi.com/blog/uploaded/WindowsLiveWriter/ProjectingtononActiveRecordclassesusingA_C76B/Post_Comment_Genius_ERD_thumb3.gif" alt="" /></p>

<p>A sample projection could be a kind of a view:</p>

<p><img src="http://kenegozi.com/blog/uploaded/WindowsLiveWriter/ProjectingtononActiveRecordclassesusingA_C76B/CommentView_Genius_ERD_thumb1.gif" alt="" /></p>

<p>The SQL is (surprise!)</p>

<p><code>
   1:  SELECT
   2:      p.Title as PostTitle, c.Content
   3:  FROM 
   4:      Comments c INNER JOIN
   5:      Posts p ON c.PostId = p.Id
</code></p>

<p>But we live in the Classes/Code/Compiler/Types/etc. domain, not the SQL domain, so I’d need a Post and a Comment classes that would derive from ActiveRecordBase&lt;&gt;. But what about the CommentsView? I can select into an array of objects using a simple HQL’s select:</p>

<p><code>
   1:  IActiveRecordQuery query = new HqlBasedQuery(typeof(Job),
</code>
   2:  “select c.Post.Title, c.Content from Comment as c”);   3:     4:  ArrayList report = ActiveRecordMediator.ExecuteQuery(query) as ArrayList;
But I do not want to, since every item in the ArrayList is of type object[]. yuck.</p>

<p>No, I want to use a CommentView class, and this syntax:
   1:  IActiveRecordQuery query = new HqlBasedQuery(typeof(Job),
   2:  “select new CommentView(c.Post.Title, c.Content) from Comment as c”);
   3:<br />
   4:  ArrayList report = ActiveRecordMediator.ExecuteQuery(query) as ArrayList;
and now the ArrayList contains CommentView objects.</p>

<p>In order to achieve that, we need to use the peculiar named attribute, [Import] like that:</p>

<p><code>
   1:  [Import(typeof(CommentView), "CommentView")]
   2:  [ActiveRecord("Comments")]
   3:  publicclass Comment : ActiveRecordBase&lt;Comment&gt; { /* blah blah */ }
</code></p>

<p>Now ActiveRecord (assuming Comment class was initialized using ActiveRecordStarter) knows that CommentView refers to a projection of the Comment ActiveRecord, using the class CommentView.</p>

<p>The use of [Import] is not documented too well, so I’ve included ImportAttribute in the post’s title so It could be easily found. After a few refinements I hope to post it to the CastleProject wiki.</p>

<p>Note <a href="http://www.ayende.com/Blog/ActiveRecordAndASPNet20.aspx">Ayende’s post</a>, with some better example for projection, but it lacks the demonstration of using Import attribute, so that’s actually the reason for this post.</p>

<p>That’s for the “how you do that”.</p>

<p>now for the “How I think you should be able to do that”:</p>

<p>well, INHO, the Import attribute is poorly named.</p>

<p>The name of the Attribute makes no sense to me.The lack of default name makes no sense to me. I should be able to </p>

<p><code>
   1:  [Import(typeof(CommentView))] 
</code></p>

<p>And what if I need some different projections to the same AR type? Multiple Import attributes make no sense, too. </p>

<p>Does the Import attribute serves a different purpose? If not – why not call it “Projects”? (since it projectsto some other classes)</p>

<p>like:</p>

<p><code>
   1:  [Projects(typeof(CommentProjectionOrWhatever))] 
   2:  publicclass Comment : ActiveRecordBase&lt;Comment&gt; { /* blah blah*/ }
</code></p>

<p>or even better yet: </p>

<p><code>
   1:  [Projects(
   2:  typeof(CommentProjectionOrWhatever), 
   3:  typeof(YetAnotherCommentProjectionNeededForDemonstrationPurposesOnly )]
</code></p>


    </section>


  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2006/10/04/allowing-xhtml-tags-intellisense-in-monorail-documents">Allowing XHTML tags intellisense in Monorail documents</a></h2>
    <div class="meta">
        <time>on October 4, 2006</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/visual-studio" rel="tag">visual-studio</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            
            
        </span>
        
    </div>
    
     <p>PROBLEM:When editing Monorail views, you are losing the XHTML intellisense that normal webforms have in Visual Studio.</p>

<p>SOLUTION:Add a proper xmlns to the html tag.My layouts start with this:</p>

<p><code>
   1:  &lt;?brail 
</code></p>

<p><code>
   2:      output '&lt;'
</code></p>

<p><code>
   3:      output '?xml version="1.0" encoding="utf-8"?'
</code></p>

<p><code>
   4:      output '&gt;'
</code></p>

<p><code>
   5:  ?&gt;
</code></p>

<p><code>
   6:  &lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN""http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;
</code></p>

<p><code>
   7:  &lt;html xmlns="http://www.w3.org/1999/xhtml" xml:lang="he-il" lang="he" &gt;
</code></p>

<p>This applies to brail, but can of course be used on any other view engine, with the needed adjustments.</p>

<p>Lines 1-5 is needed due to a bug(?) in some versions of brail. brail used to recognize a script by ‘<? ?>’, ‘<?brail ?>’ and ‘&lt;% %&gt;’ signs. therefore, using a <?xml ?> declaration caused the boo compiler to say that he knows nothing about ‘xml’. I think that Ayende has solved the problem now, by allowing only ‘<?brail ?>’, but I think it’s not yet on the main trunk, so I still use the listed method.</p>

<p>Line 6 is the DOCTYPE, I use XHTML 1.0 transitional.</p>

<p>Line 7 is the magic part. Visual Studio parses this line, reads the xmlns, and can hint you with intellisense forhtml tags and attributes. The xml:lang and lang attributes are of course changeable.</p>

<p>It works in layouts, or in views that are a full html document (with &lt;html&gt; tag) but not with VieComponents or views that uses layouts.</p>

<p>If someone has a way to do that, please share it.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2006/09/20/my-presentation-layer-of-choice-brail-over-castles-monorail">My presentation layer of choice: Brail over Castle's MonoRail</a></h2>
    <div class="meta">
        <time>on September 20, 2006</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/architecture" rel="tag">architecture</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            
            
        </span>
        
    </div>
    
     <p>I’ve evaluated some methods to rail and to MVC in the .NET world, without using webforms.</p>

<p>The first method I tried was to treat aspx’s kind’a like old ASP, no server controls, allowing multiple forms, no __VIEWSTATE __EVANTVALIDATION __UGLYHIDDENFIELD in the generated markup, and calling actions on the server, implemented as Controllers over ashx’s, or directly linking to a new .aspx view (if no operation is required).It allowed me to create super clean html, but it has it’s limits, since I’ve had to implement a mechanism for MasterPages and UserControls, and that suck.There is <a href="http://www.boo-lang.org/BooWebbness/Home/Index.ashx">BooWebness</a>. Seams like a great effort, and I like the natural .ashx approach, but I am not very into its whole framework there.</p>

<p>Then I’ve went after <a href="http://www.castleproject.org/index.php/MonoRail">MonoRail</a>.Cool.Has a lot out-of-the-box, including MasterPages(Layouts), UserControls(ViewComponents), Markup Helpers, AjaxHelpers, and a large community. Being part of Castle is a Big Bonus. I believe in Castle. I’ve been using Castle’s ActiveRecord for a while and I find it almost too good to be true. So MonoRail fits well in Castle’s world, so I’m into it. </p>

<p>Now I needed to choose a view engine.<a href="http://www.castleproject.org/index.php/MonoRail:NVelocity">NVelovity</a> was disqualified for its discontinuesness, and the need to learn something new and narrow. Not to mention the fact that it’s interpreted.The WebForms hybrid just doesn’t look too good.<a href="http://www.ayende.com/projects/brail.aspx">Brail</a> from <a href="http://www.ayende.com/">Ayende</a> is very nice. Learning Boo isn’t like learning a new thing, since I’ve had a little taste of it in the past, and since it’s .NET, and since it has a very readable syntax that any C#/VB.NET/Python/Perl/java/you-name-it developer can learn in minutes. Brail is a lovely name, and I can count on Ayende to keep developing it as much as it’s needed.</p>

<p>So Brail over MonoRail it is.</p>

<p>Posts about the matter will come shortly.</p>


    </section>


  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2006/09/20/htmlhelper-vs-html-tags">HtmlHelper vs. html tags</a></h2>
    <div class="meta">
        <time>on September 20, 2006</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            
            
        </span>
        
    </div>
    
     <p>Should I use HtmlHelper?</p>

<p>take a look at this:
${HtmlHelper.Form(‘/Home/Search.rails’)} ${HtmlHelper.LabelFor(‘q’,’search:’)} ${HtmlHelper.InputText(‘q’, ‘’, 50, 50)} ${HtmlHelper.SubmitButton(‘Search’)} ${HtmlHelper.EndForm()} 
and that:
&lt;form method="post" action="Home/Search.rails"&gt;<label for="q">Search:</label><input type="text" name="q" /><input type="submit" value="Search" />&lt;/form&gt;
Okay. So AjaxHelper is cool, and maybe FormHelper will have someAdded Value in it, but I cannot figure out yet the benefits of using HtmlHelper, especially for non-data elements, such as <label></label></p>

<p>If you have a good reason to use HtmlHelper, please enlight my.</p>


    </section>


  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2006/09/20/brail-and-xmling-the-markup">Brail and xml-ing the markup</a></h2>
    <div class="meta">
        <time>on September 20, 2006</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/monorail" rel="tag">monorail</a>
            
            
        </span>
        
    </div>
    
     <p>I like XHTML more than I like HTML.</p>

<p>But IE doesn’t think so.</p>

<p>He needs the markup to be <em>very</em> explicit about the web page being xhtml.</p>

<p>.xhtml isn’t enough, and even not Doctype-ing.</p>

<p>No. he must have the optional <?xml version="1.0" ?>.</p>

<p>So I’ve added it to my Layout.boo file.</p>

<p>Boo? Boom. Boo marks macros (such as <?brail ?>) with <? ?> blocks, and Boo doesn’t recognize a macro with the name xml.</p>

<p>My current solution is to write:
<?brail output '<' output '?xml version="1.0" ?'output '>' ?>
I guess that adding a dummy xml macro would make the boo templates look nicer, but it is an ugly solution, and since (ugly &amp; nice != nice), we need a better solution.</p>

<p>Maybe a change in Brail (on BrailPreProcessor.boo), to transform <?xml ... ?> stuff to it’s “output” equiv, can be done. </p>


    </section>


  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2006/09/07/inheritence-in-castles-activerecord">Inheritence in Castle's ActiveRecord</a></h2>
    <div class="meta">
        <time>on September 7, 2006</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/c-sharp" rel="tag">c-sharp</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/activerecord" rel="tag">activerecord</a>
            
            
        </span>
        
    </div>
    
     <p>The reference I’ve used whilelearning to use Castl’e ActiveRecord implementation is the Blog/Post demos that can be found on Castle’s site.</p>

<p>Let’s look at the Type Hierarchy example, that can be found here.</p>

<p>It shows an implementation of a class diagram that look a little bit like this:<img src="http://kenegozi.com/blog/uploaded/Company_Entity_Person_Class_Diagram.GIF" alt="Class Diagram" /></p>

<p>Let’s look at the code :
[ActiveRecord(“entity”), JoinedBase]publicclassEntity : ActiveRecordBase{privateint _id;[PrimaryKey]publicint Id{get { return id; }set { id = value; }}}[ActiveRecord(“entitycompany”)]publicclassCompanyEntity : Entity{privateint comp_id;[JoinedKey(“comp_id”)]publicint CompId{get { return comp_id; }set { comp_id = value; }}}[ActiveRecord(“entityperson”)]publicclassPersonEntity : Entity{privateint person_id;[JoinedKey(“person_id”)]publicint PersonId{get { return person_id; }set { person_id = value; }}}
But look what happens. since the Id property on entity is public and inherited to the subclasses, you get something like this:<img src="http://kenegozi.com/blog/uploaded/IdOrPersonId.GIF" alt="Should I use .Id or .PersonId?" /></p>

<p>So there is a duplicate field here !!!. and it’s not only a getter-setter thingie. It also have different private members.</p>

<p>My solution for this is to virtualize the base Id, and protectedize (hehe) the _id member, like this:</p>

<p>[ActiveRecord(“entity”), JoinedBase]publicclassEntity : ActiveRecordBase{protectedint _id;[PrimaryKey]publicvirtualint Id{get { return id; }set { id = value; }}}[ActiveRecord(“entitycompany”)]publicclassCompanyEntity : Entity{[JoinedKey(“comp_id”)]publicoverrideint Id{get { return _id; }set { _id = value; }}}[ActiveRecord(“entityperson”)]publicclassPersonEntity : Entity{[JoinedKey(“person_id”)]publicoverrideint Id{get { return _id; }set { _id = value; }}}
Now it makes more sence:<img src="http://kenegozi.com/blog/uploaded/NowOnlyId.GIF" alt="I should use .Id" /></p>

<p>And before you hit me with a big stick - I do know of ActiveRecordBase<t> . :) the above code is for demonstration purposes only, not to be Copy&amp;Pasted to your Brand-New-Best-Erp-Ever-Made-And-Will-Make-You-Rich</t></p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2006/08/26/activerecordbase-vs-activerecordmediator">ActiveRecordBase vs ActiveRecordMediator</a></h2>
    <div class="meta">
        <time>on August 26, 2006</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/architecture" rel="tag">architecture</a>
            ,&nbsp;
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/activerecord" rel="tag">activerecord</a>
            
            
        </span>
        
    </div>
    
     <p>So after a lot of talking about the matter, I’m starting a little (but real) project with <a href="http://www.castleproject.org/index.php/ActiveRecord">Castle’s ActiveRecord</a> as an ORM service.</p>

<p>What I’m still not sure about, is weather I should inherit everything from <a href="http://castleproject.org/API/Castle.ActiveRecord.ActiveRecordBase.html">ActiveRecordBase</a>, or have my own base class and use <a href="http://castleproject.org/API/Castle.ActiveRecord.ActiveRecordMediator.html">ActiveRecordMediator</a>?</p>

<p>Sure, I can derive my base class from ActiveRecordBase and have common behaviour for my model, but I am still not sure that I’m fully into the ActiveRecord pattern as a whole. It’s tempting to exploit Castle’s implementation but to keep the methods in a seperate class rather than in the model itself.</p>

<p>I also have some problem with the need to do FindAll, Find, etc. on each class so to expose the static methods in a typed way.</p>

<p>Well, I take back the last paragraph, since Icould use ActiveRecordBase&lt;&gt; and it solves this problem.</p>

<p>To conclude: I tend to go with subclassing ActiveRecordBase&lt;&gt; as a base class for my model, and I’m starting to code (and test) that way,but I could still use the knowledge gained by people with real experience withthis implementation…</p>

<p>I’ve looked for insights on the matter on the web, and have found nothing.If anyone reading this has an insight about the matter, please comment here, so people who do their first steps in Castle’s ActiveRecord implementation would have a better kick start regarding this issue.</p>


    </section>


  
  
  
  
  
  
  
  
    

    <section class="container content post">
    <h2><a href="/blog/2006/08/26/activerecord-beginners-resources">ActiveRecord Beginner's Resources</a></h2>
    <div class="meta">
        <time>on August 26, 2006</time>&nbsp;&nbsp;
        <span class="tags">
            
            <a href="/blog/tag/castle" rel="tag">castle</a>
            ,&nbsp;
            
            <a href="/blog/tag/activerecord" rel="tag">activerecord</a>
            
            
        </span>
        
    </div>
    
     <p>I’ll post here links for stuff that I find usefull, for people who are doing their first steps in the Castle’s ActiveRecord’s world.</p>

<p>This post is to be updated while finding more resources.</p>

<p>Note that this is not a replacement for the official ducomentation that can be found on Castle’s website, but merely a place to do the beginner’s life somewhat easier.</p>

<p>Posts by <a href="http://hammett.castleproject.org/">Hamilton <em>hammett</em> Verissimo</a>, who is the engine behind the whole story:<a href="http://geekswithblogs.net/hammett/articles/76697.aspx">http://geekswithblogs.net/hammett/articles/76697.aspx</a><a href="http://geekswithblogs.net/hammett/articles/76809.aspx">http://geekswithblogs.net/hammett/articles/76809.aspx</a>make sure that you are following <a href="http://hammett.castleproject.org/">his blog</a>.</p>

<p>An article by Ayende about using Generics with ActiveRecord:[http://www.castleproject.org/index.php/ActiveRecord,<em>.Net_2.0_and_Generics](http://www.castleproject.org/index.php/ActiveRecord,</em>.Net_2.0_and_Generics)as before - stay tuned to <a href="http://www.ayende.com/blog">Ayende’s blog</a> for he very experienced in ActiveRecord and in NHibernate too, for the matter. He is also avery readablewriter.</p>


    </section>


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
</section>


	<!-- FOOTER -->
	<footer id="footer" class="section">
		<div class="container">
			<p class="copyright pull-left">
				&copy; 2014. Ken Egozi. All Rights Reserved.
				<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
					<img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-sa/4.0/88x31.png" />
				</a>
				</p>
		</div>
	</footer>
	<!-- END FOOTER -->
	<div class="back-to-top">
		<a href="#top"><i class="fa fa-chevron-up"></i></a>
	</div>

	<script src="/assets/javascripts/jquery-2.1.0.min.js"></script>
	<script src="/assets/javascripts/jquery.localScroll.min.js"></script>
	<script src="/assets/javascripts/looper.min.js"></script>
	<script src="/assets/javascripts/bootstrap.min.js"></script>
	<script src="/assets/javascripts/site.js"></script>
</body>
</html>
